if (self.CavalryLogger) { CavalryLogger.start_js(["DDuIC"]); }

__d("ChatSidebarParticipantTooltipBuilder",["fbt","React"],(function(a,b,c,d,e,f,g){"use strict";b("React");var h=10,i="\n";function a(a,b){var c=[],d=Math.min(h,a.length);a=a.slice(0,d);a.forEach(function(a){a=a.name;a&&c.push(a)});d<b&&c.push(g._("and {num} more...",[g._param("num",b-d)]));return c.join(i)}e.exports={buildParticipantsTooltip:a,MAX_NUM_PARTICIPANTS_TO_RENDER:h}}),null);
__d("OrderedFriendsList",["AvailableListConstants","ChatProfileStore","ChatSidebarParticipantTooltipBuilder","ChatSidebarPreloadStore","CurrentUser","MercuryIDs","PresenceStatus","SearchableEntry","ShortProfiles","createArrayFromMixed","isValidUniqueID"],(function(a,b,c,d,e,f){"use strict";var g=null,h={},i=[],j={};function k(a){a=String(a);return b("MercuryIDs").isValid(a)?a:b("MercuryIDs").getParticipantIDFromUserID(a)}function l(a,c){a=b("createArrayFromMixed")(a);c(a.filter(function(a){a=b("ShortProfiles").getNow(a);return!a||o(a)||a.is_nonfriend_messenger_contact}))}function m(a){g=[];var c=0;a.forEach(function(a){var d=a.slice(0,-2);a=a.slice(-1);b("PresenceStatus").get(d)==a&&(g[c]=d,h[d]=c++)})}function n(a){var c=0;a.forEach(function(a){var d=a.slice(0,-2);a=a.slice(-1);a==b("AvailableListConstants").ACTIVE&&(i[c]=d,j[d]=c++)})}function o(a){return a.type==="friend"||b("CurrentUser").isWorkUser()&&a.type==="fb4c"}var p={contains:function(a){return a in h},getList:function(a){if(g&&g.length){l(g,a);return}b("ChatSidebarPreloadStore").onLoaded(function(b){b=b.buddies;m(b);l(g,a)})},getSearchableEntries:function(a,c,d){p.getList(function(e){b("ChatSidebarPreloadStore").onLoaded(function(f){var g=f.groups,h=f.recentPageList;b("ShortProfiles").getMulti(e.slice(0,a),function(a){var b=[];for(var e in a)b.push(p.normalizeProfileEntry(a[e],e));a=c?g.map(p.normalizeThreadEntry):[];var f=h.map(p.normalizePageEntry);d(b.concat(a,f).filter(function(a){return!!a}).sort(function(a,b){return a.getOrder()-b.getOrder()}))})})})},normalizePageEntry:function(a,c){var d=a.searchTokens||[],e=a.name,f=null;return new(b("SearchableEntry"))({uniqueID:a.id||c,keywordString:d.join(" "),order:c,photo:a.imgSrc,title:e,subtitle:f,type:"page",uri:a.uri,auxiliaryData:{isVerified:a.isVerified}})},normalizeProfileEntry:function(a,c){var d=a.searchTokens||[],e=a.name,f=null;return new(b("SearchableEntry"))({uniqueID:a.id||c,keywordString:d.join(" "),order:p.getRank(a.id||c),photo:a.thumbSrc,title:e,subtitle:f,type:a.type,uri:a.uri,auxiliaryData:{isMessengerUser:a.is_messenger_user}})},normalizeThreadEntry:function(a,c){var d=a.mercury_thread,e=a.participants_to_render.map(function(a){return babelHelpers["extends"]({},a,{id:k(a.id)})});d.participants=d.participants.map(k);var f=a.text,g=null;f||(f=d.name);var h=b("ChatSidebarParticipantTooltipBuilder").buildParticipantsTooltip(e,d.participants.length-1),i=e.map(function(a){return a.name}).join(", ");!f?f=i:g=i;i=a.uid;return!f||!b("isValidUniqueID")(i)?null:new(b("SearchableEntry"))({uniqueID:i,order:c,photo:d.image_src,title:f,subtitle:g,type:"thread",auxiliaryData:{participantsToRender:e,tooltipContent:h,thread:d}})},getRank:function(a){return a in h?h[a]:g?g.length:0},getActiveList:function(a){if(i.length>0){a(i);return}p.getList(function(b){return a(b)})},getActiveRank:function(a){return a in j?j[a]:p.getRank(a)}};(function(){b("ChatSidebarPreloadStore").onLoaded(function(a){var c=a.buddies;a=a.shortProfiles;b("ShortProfiles").setMulti(a);n(c);m(c)}),b("ChatProfileStore").init()})();e.exports=p}),null);
__d("VerseSidebarUtil",["Bootloader","CSS","DOM","ge"],(function(a,b,c,d,e,f){"use strict";function g(){var a=document.documentElement||"";b("CSS").addClass(a,"buddylistOff")}var h={show:function(){g();if(b("ge")("pagelet_verse_sidebar"))return;b("Bootloader").loadModules(["UIPagelet"],function(a){var c=b("DOM").create("div",{id:"pagelet_verse_sidebar"});b("DOM").appendContent(document.body,c);a.loadFromEndpoint("VerseSidebarPagelet","pagelet_verse_sidebar",{path:""})},"VerseSidebarUtil")},remove:function(){var a=b("ge")("pagelet_verse_sidebar");a&&b("DOM").remove(a)},removeAndHideMessenger:function(){g(),h.remove()}};e.exports=h}),null);
__d("PrivacyLiteFlyoutBootloader",["regeneratorRuntime","Promise","Deferred","JSResource"],(function(a,b,c,d,e,f){"use strict";var g=!1,h=null,i=null,j={loadFlyout:function(){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:a.next=2;return b("regeneratorRuntime").awrap(j._loadFlyout(!1));case 2:case"end":return a.stop()}},null,this)},loadFlyoutAsChild:function(){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:a.next=2;return b("regeneratorRuntime").awrap(j._loadFlyout(!0));case 2:case"end":return a.stop()}},null,this)},_loadFlyout:function(a){var c,d,e,f,h,i,j,k,l,m;return b("regeneratorRuntime").async(function(n){while(1)switch(n.prev=n.next){case 0:if(!g){n.next=2;break}return n.abrupt("return");case 2:g=!0;n.next=5;return b("regeneratorRuntime").awrap(b("Promise").all([b("JSResource")("PrivacyLiteFlyout").__setRef("PrivacyLiteFlyoutBootloader").load(),this._getDeferredFlyoutElements().getPromise(),this._getDeferredFooterElements().getPromise()]));case 5:c=n.sent,d=c[0],e=c[1],f=e.flyout,h=e.flyoutRoot,i=c[2],j=i.footer,k=i.event,l=i.settingsExitPoint,m=i.basicsExitPoint,d.setIsChild(!!a),d.registerFlyoutToggler(f,h),d.registerSettingsAndBasicsLinkLogging(j,k,l,m),d.loadBody();case 19:case"end":return n.stop()}},null,this)},setChildFlyoutVisible:function(a){var c,d,e,f;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:if(!(!g&&!a)){h.next=2;break}return h.abrupt("return");case 2:h.next=4;return b("regeneratorRuntime").awrap(b("Promise").all([b("JSResource")("PrivacyLiteFlyout").__setRef("PrivacyLiteFlyoutBootloader").load(),this._getDeferredFlyoutElements().getPromise()]));case 4:c=h.sent;d=c[0];e=c[1];f=e.flyout;e._flyoutRoot;if(!(a===d.isFlyoutVisible())){h.next=11;break}return h.abrupt("return");case 11:d.setChildFlyoutVisible(a),d.onToggle(f,a?"show":"hide");case 13:case"end":return h.stop()}},null,this)},_getDeferredFlyoutElements:function(){h==null&&(h=new(b("Deferred"))());return h},registerFlyoutElements:function(a,b){this._getDeferredFlyoutElements().resolve({flyout:a,flyoutRoot:b})},_getDeferredFooterElements:function(){i==null&&(i=new(b("Deferred"))());return i},registerFooterElements:function(a,b,c,d){this._getDeferredFooterElements().resolve({footer:a,event:b,settingsExitPoint:c,basicsExitPoint:d})}};e.exports=j}),null);
__d("HelpLiteFlyout",["Arbiter","AsyncRequest","CSS","DOM","Event","HelpLiteFlyoutBootloader","PrivacyLiteFlyoutBootloader","Toggler","ge","ifRequired"],(function(a,b,c,d,e,f){"use strict";var g=null,h={loadBody:function(){b("ge")("fbHelpLiteFlyoutLoading")&&new(b("AsyncRequest"))("/help/ajax/contextual/").setData({page_type:b("HelpLiteFlyoutBootloader").getHelpType()}).send()},refreshHelp:function(){b("ge")("fbHelpLiteFlyoutLoading")&&new(b("AsyncRequest"))("/help/ajax/contextual/").setData({page_type:b("HelpLiteFlyoutBootloader").getHelpType(),is_refresh:!0}).send()},resetHelp:function(a){var c=b("ge")("fbContextualHelpContent");c&&b("DOM").replace(c,a);h.isFlyoutVisible()?h.refreshHelp():b("ifRequired")("WorkGalahadQuickHelpNub.react",function(){h.refreshHelp()})},showHelp:function(){b("PrivacyLiteFlyoutBootloader").setChildFlyoutVisible(!1),b("CSS").show(b("ge")("fbHelpLiteFlyout"))},openPrivacy:function(){b("CSS").hide(b("ge")("fbHelpLiteFlyout")),b("PrivacyLiteFlyoutBootloader").loadFlyoutAsChild(),b("PrivacyLiteFlyoutBootloader").setChildFlyoutVisible(!0)},registerPrivacyBackLink:function(a){b("Event").listen(a,"click",h.showHelp)},registerFlyoutToggler:function(a,c){g=c;a=b("Toggler").createInstance(a);a.setSticky(!1);b("Toggler").listen("hide",c,function(a){b("Arbiter").inform("layer_hidden",{type:"HELP_LITE"}),b("PrivacyLiteFlyoutBootloader").setChildFlyoutVisible(!1)});b("Toggler").listen("show",c,function(a){b("Arbiter").inform("layer_shown",{type:"HELP_LITE"}),h.showHelp()})},isFlyoutVisible:function(){return g&&b("Toggler").getActive()===g},setFlyoutVisible:function(a){a&&b("HelpLiteFlyoutBootloader").loadFlyout(),a?b("Toggler").show(g):b("Toggler").hide(g)}};e.exports=h}),null);
__d("ChatSidebarPresencePrivacyStore",["ChatDispatcher","ChatSidebarPresencePrivacyActions","FluxReduceStore","PresencePrivacy"],(function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return{currentUser:b("PresencePrivacy").getVisibility(),onlinePolicy:b("PresencePrivacy").getOnlinePolicy(),friends:b("PresencePrivacy").getFriendsVisibility()}};d.reduce=function(a,c){switch(c.type){case b("ChatSidebarPresencePrivacyActions").PRIVACY_CHANGED:return{onlinePolicy:b("PresencePrivacy").getOnlinePolicy(),currentUser:b("PresencePrivacy").getVisibility(),friends:b("PresencePrivacy").getFriendsVisibility()};case b("ChatSidebarPresencePrivacyActions").USER_PRESENCE_CHANGED:return babelHelpers["extends"]({},a,{onlinePolicy:b("PresencePrivacy").getOnlinePolicy(),currentUser:b("PresencePrivacy").getVisibility()})}return a};d.isUserOffline=function(){return this.getState().currentUser===b("PresencePrivacy").OFFLINE};return c}(b("FluxReduceStore"));a.__moduleID=e.id;e.exports=new a(b("ChatDispatcher"))}),null);
__d("ChatSidebarHideReason",[],(function(a,b,c,d,e,f){a=Object.freeze({VIEWPORT_INCAPABLE:0,LOW_FRIEND_COUNT:1,NOT_ENABLED:2,OFF_HOMEPAGE:3});e.exports=a}),null);
__d("ChatSidebarVisibility",["ChatConfig","ChatSidebarHideReason","ChatSidebarStore","OrderedFriendsList","URI","getViewportDimensions"],(function(a,b,c,d,e,f){"use strict";var g,h=b("ChatConfig").get("sidebar.min_friends"),i=b("ChatConfig").get("sidebar.minimum_width"),j=b("ChatConfig").get("sidebar.hide_divebar_off_homepage"),k={getViewport:function(){return b("getViewportDimensions")()},shouldShowSidebar:function(a,c,d){k.shouldShowSidebarIgnoreEnabled(a,function(a,d){var e=b("ChatSidebarStore").isEnabled();c(a&&e,e?d:d.concat([b("ChatSidebarHideReason").NOT_ENABLED]))},d)},shouldShowSidebarIgnoreEnabled:function(a,c,d){var e=this;b("OrderedFriendsList").getActiveList(function(f){var g=a||k.getViewport();g=g.width>i;f=f.length<h;var l=!0,m=[];j&&!e.isOnHomepage(d)&&(l=!1,m.push(b("ChatSidebarHideReason").OFF_HOMEPAGE));g||(l=!1,m.push(b("ChatSidebarHideReason").VIEWPORT_INCAPABLE));f&&(l=!1,m.push(b("ChatSidebarHideReason").LOW_FRIEND_COUNT));c(l,m)})},isOnHomepage:function(a){a=a?a.getPath():new(g||(g=b("URI")))(window.location.href).getPath();return a==="/"},isSidebarVisible:function(){return b("ChatSidebarStore").getVisibleType()==="sidebar"},isBuddyListVisible:function(){return b("ChatSidebarStore").getVisibleType()==="buddylist"}};e.exports=k}),null);
__d("onAfterDisplay",["NavigationMetrics","TimeSlice","requestIdleCallback"],(function(a,b,c,d,e,f){"use strict";var g=[],h=!1;function a(a){a=b("TimeSlice").guard(a,"onAfterDisplay invocation",{propagationType:b("TimeSlice").PropagationType.ORPHAN});h?b("requestIdleCallback")(a):g.push(a)}b("NavigationMetrics").addRetroactiveListener(b("NavigationMetrics").Events.EVENT_OCCURRED,function(a,c){["all_pagelets_displayed","e2e"].indexOf(c.event)>-1&&!h&&(h=!0,g.forEach(function(a){b("requestIdleCallback")(a)}))});e.exports=a}),null);
__d("ChatSidebar",["csx","Arbiter","AsyncRequest","Bootloader","ChatConfig","ChatDispatcher","ChatPerfInstrumentation","ChatSidebarActions","ChatSidebarBotsDispatcher","ChatSidebarBotsStore","ChatSidebarCachedViewport","ChatSidebarPresencePrivacyStore","ChatSidebarStore","ChatSidebarVisibility","CSS","CurrentUser","DOM","DOMDimensions","Event","LitestandClassicPlaceHolders","Parent","PresencePrivacy","PresenceUtil","SidebarAppsInitialVisibility","SidebarWorkTopGroupsVisibility","Style","TimeSlice","URI","ViewportBounds","emptyFunction","ge","gkx","ifRequired","onAfterDisplay","onAfterLoadSafe","queryThenMutateDOM","requireWeak"],(function(a,b,c,d,e,f,g){var h,i=b("ChatSidebarBotsDispatcher").module,j=b("ChatSidebarBotsStore").module,k,l,m,n,o,p,q=!0,r=b("ChatSidebarCachedViewport").viewport,s=44,t=117,u=40,v=32,w=44,x=30,y=171,z=b("ChatConfig").get("expanded_divebar_width"),A=b("ChatConfig").get("sidebar.hide_buddylist_off_homepage"),B=b("ChatConfig").get("sidebar.hide_buddylist_off_allpage"),C="buddylistOff";function D(){return b("ChatSidebarStore").getVisibleType()==="sidebar"}function E(a,b){if(!D())return;b?n.hide():(n.show(),I())}function F(){return!D()||!m?0:z}function G(){b("CSS").removeClass(document.documentElement,"sidebarMode");var a=B||A&&new(h||(h=b("URI")))(window.location.href).getPath()!=="/";a?b("CSS").addClass(document.documentElement,C):(b("CSS").removeClass(document.documentElement,C),(A||B)&&b("Bootloader").loadModules(["Dock"],function(a){a.resizeAllFlyouts()},"ChatSidebar"));b("ChatSidebarStore").isInitialized()&&(n.hide(),b("CSS").hide(m),b("CSS").hide(l));b("Arbiter").inform("sidebar/visibility",!1,"state");b("Arbiter").inform("reflow");b("ViewportBounds").inform("change")}function H(a){I(a,R._cacheViewport)}function I(a,c){var d;b("queryThenMutateDOM")(function(){c&&c(),(!a||a.height!==r.height)&&(d=N())},function(){(a==null||a.width!==r.width)&&b("ChatSidebarVisibility").shouldShowSidebar(r,function(a,c){b("ChatSidebarActions").show(a?"sidebar":"buddylist")}),O(d)})}function J(){b("ChatSidebarVisibility").shouldShowSidebar(r,function(a,c){b("ChatSidebarActions").show(a?"sidebar":"buddylist")}),O(N())}function K(a){b("Bootloader").loadModules(["KeyboardShortcuts"],function(c){c.register("q",function(c){if(b("ChatSidebarStore").getVisibleType()!=="sidebar")return;b("requireWeak")("ChatTypeaheadCore",function(b){b.focusSearchField(a,c)})},{persistOnTransition:!0})},"ChatSidebar")}function L(a){var c=r||b("ChatSidebarVisibility").getViewport(),d=c.height;a&&a.length?(a.forEach(function(a){a&&a!==k&&!b("CSS").hasClass(a,"hidden_elem")&&(d-=b("DOMDimensions").getElementDimensions(a).height)}),p&&(d-=p.getOffset()),o&&(d-=b("DOMDimensions").getElementDimensions(o).height)):(b("ifRequired")("AppsDivebarDisplayController",function(a){a.isVisible()&&(d-=y)},function(){b("SidebarAppsInitialVisibility").visible&&(d-=y)}),b("CurrentUser").isWorkUser()&&(j&&j.hasBots()&&(d-=t),b("SidebarWorkTopGroupsVisibility").visible&&(d-=u*b("SidebarWorkTopGroupsVisibility").numGroups+v),b("gkx")("678652")&&(d-=w)),d-=s,d-=x);return Math.max(0,d)}function M(){var a;(a=b("CSS")).show(l);a.show(m);a.addClass(document.documentElement,"sidebarMode");a.removeClass(document.documentElement,C);A&&b("Bootloader").loadModules(["Dock"],function(a){a.resizeAllFlyouts()},"ChatSidebar");n.show();b("Arbiter").inform("sidebar/visibility",!0,"state");b("LitestandClassicPlaceHolders").destroy("sidebar");b("ViewportBounds").inform("change")}function N(){return{body:R.getBodyHeight(),item:n.getItemHeight()}}function O(a){if(!a)return;var c=8,d=Math.floor((a.body-c)/a.item);n.setNumTopFriends(d,q,"sidebar");q=!1;d=Math.floor(a.body-c);b("Style").set(k,"height",a.body+"px");b("Arbiter").inform("sidebar/resized",d,"state");b("Arbiter").inform("reflow")}function P(){var a;b("queryThenMutateDOM")(function(){a=N()},function(){return O(a)})}function Q(){new(b("AsyncRequest"))("/ajax/chat/settings.php").setHandler(b("emptyFunction")).setErrorHandler(b("emptyFunction")).setData({sidebar_mode:b("ChatSidebarStore").isEnabled(),window_id:b("PresenceUtil").getSessionID()}).setAllowCrossPageTransition(!0).send()}var R={init:function(a,c){R.init=b("emptyFunction"),b("ChatPerfInstrumentation").initDivebar(),b("ChatDispatcher").explicitlyRegisterStore(b("ChatSidebarStore")),b("ChatDispatcher").explicitlyRegisterStore(b("ChatSidebarPresencePrivacyStore")),i&&j&&i.explicitlyRegisterStore(j),b("ChatSidebarActions").loaded(),m=a,n=c,k=b("DOM").find(a,"div.fbChatSidebarBody"),l=b("DOM").find(a,"._51x_"),o=b("DOM").find(a,"._5qqe"),b("Event").listen(window,"resize",function(){var a=babelHelpers["extends"]({},r)||{};H(a)}),b("Arbiter").subscribe("page_transition",function(a,c){b("ChatSidebarVisibility").shouldShowSidebar(r,function(a,d){d=document.documentElement||"";A&&c.uri.getPath()!=="/"?b("CSS").addClass(d,C):b("CSS").removeClass(d,C);b("ChatSidebarActions").show(a?"sidebar":"buddylist")},c.uri)}),b("gkx")("678653")?b("onAfterDisplay")(function(){K(a)}):K(a),n.setScrollContainer(b("Parent").byClass(n.getRoot(),"uiScrollableAreaWrap")),b("Arbiter").subscribe("chat/option-changed",function(a,b){a=b.name;(a==="hide_groups"||a==="hide_admined_pages"||a==="hide_businesses")&&P()}),b("Arbiter").subscribe(["AppsDivebar/show-apps","AppsDivebar/hide-apps","PagesDivebar/show-pages","PagesDivebar/hide-pages"],P),b("Arbiter").subscribe("sidebar/typeahead/active",E),b("PresencePrivacy").subscribe("privacy-user-presence-changed",function(){I(),b("ChatSidebarActions").userPresenceChanged()}),b("PresencePrivacy").subscribe("privacy-changed",function(){I(),b("ChatSidebarActions").privacyChanged()}),b("ChatSidebarStore").addListener(function(){var a=b("ChatSidebarStore").getState(),c=b("ChatSidebarStore").getPrevState();if(a.visible!==c.visible)switch(a.visible){case"sidebar":M();break;case"buddylist":G();break}a.enabled!==c.enabled&&Q()}),j&&j.addListener(function(){return P()}),b("gkx")("678654")?(J(),b("onAfterLoadSafe")(function(){if(r.needsRefresh){var a=b("ChatSidebarStore").getState().visible==="sidebar";H();b("onAfterLoadSafe")(function(){a!==(b("ChatSidebarStore").getState().visible==="sidebar")&&b("Bootloader").loadModules(["ChatReliabilityInstrumentation"],function(a){a.logERROR("sidebar flashed")},"ChatSidebar")})}})):H(),b("onAfterLoadSafe")(function(){b("Bootloader").loadModules(["ChatImpressionLogger"],function(a){a.init(n)},"ChatSidebar")}),b("ViewportBounds").addPersistentRight(F),b("Arbiter").inform("sidebar/initialized",R,"state"),b("ChatSidebarActions").init(),b("ChatPerfInstrumentation").logSIDEBAR_DISPLAY_DONE()},ensureLoaded:function(){if(!b("ChatSidebarStore").isEnabled())return;if(b("ChatSidebarStore").isLoaded())return;if(b("ge")("pagelet_sidebar"))return;b("Bootloader").loadModules(["UIPagelet"],function(a){var c=b("DOM").create("div",{id:"pagelet_sidebar"});b("DOM").appendContent(document.body,c);a.loadFromEndpoint("SidebarPagelet","pagelet_sidebar")},"ChatSidebar");b("ChatSidebarActions").loaded()},showBuddylistForCurrentPage:function(){if(!b("ChatSidebarStore").isEnabled())return;b("ChatSidebarActions").show("buddylist")},hide:function(){if(!b("ChatSidebarStore").isEnabled())return;b("ChatSidebarActions").disable()},unhide:function(){if(b("ChatSidebarStore").isEnabled())return;b("ChatSidebarVisibility").shouldShowSidebarIgnoreEnabled(null,function(a,c){b("ChatSidebarActions").enable(a?"sidebar":"buddylist")})},_cacheViewport:function(){r=b("ChatSidebarVisibility").getViewport()},getBodyHeight:function(){return b("gkx")("678259")?L():L(Array.from(l.childNodes))}};R.init=b("TimeSlice").guard(R.init,"ChatSidebar init");e.exports=R}),null);