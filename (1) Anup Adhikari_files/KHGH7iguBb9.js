if (self.CavalryLogger) { CavalryLogger.start_js(["iLiuR"]); }

__d("VideoCopyrightMatchStatus",[],(function(a,b,c,d,e,f){e.exports={NEW_MATCH:"NEW_MATCH",REPORTED:"REPORTED",ALLOWED:"ALLOWED",ADDED_MATCH:"ADDED_MATCH",REMOVED:"REMOVED",IN_DISPUTE:"IN_DISPUTE",BLOCKED:"BLOCKED",CLAIMED:"CLAIMED",MONITORED:"MONITORED",MANUAL_REVIEW:"MANUAL_REVIEW",REPORTED_OR_REMOVED:"REPORTED_OR_REMOVED",APPEALED:"APPEALED",OTHER:"OTHER"}}),null);
__d("VideoCopyrightRuleGraphFields",[],(function(a,b,c,d,e,f){e.exports={ID:"id",NAME:"name",MIGRATION_RULE_ID:"migration_rule_id",COPYRIGHTS:"copyrights",CONDITION_GROUPS:"condition_groups",CREATOR:"creator",CREATED_DATE:"created_date",COPYRIGHTS_COUNT:"copyrights_count",MATCHES_COUNT:"matches_count",IS_IN_MIGRATION:"is_in_migration",IS_NEW_VERSION_RULE:"is_new_version_rule",EXCLUDED_COPYRIGHT_IDS:"excluded_copyright_ids",ACTION:"action",CONDITIONS:"conditions",VALIDITY_STATUS:"validity_status",TYPE:"type",OPERATOR:"operator",VALUE:"value"}}),null);
__d("VideoReferenceMatchState",[],(function(a,b,c,d,e,f){e.exports={CONFLICT:"CONFLICT",DISPUTED:"DISPUTED",DISPUTE_ACCEPTED:"DISPUTE_ACCEPTED",DISPUTE_REJECTED:"DISPUTE_REJECTED",CONFLICT_RESOLVED:"CONFLICT_RESOLVED",AUTO_RESOLVED:"AUTO_RESOLVED",INACTIVE:"INACTIVE",DISPUTE_EXPIRED:"DISPUTE_EXPIRED",OPS_RESOLVED:"OPS_RESOLVED",CONFLICT_EXPIRED:"CONFLICT_EXPIRED",POSSIBLE_CONFLICT:"POSSIBLE_CONFLICT",OWNERSHIP_ASSERTED:"OWNERSHIP_ASSERTED"}}),null);
__d("PageContentTabRightsManagerStore",["Arbiter","EventEmitter","PageContentTabConstants"],(function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var b;b=a.call(this)||this;b.$PageContentTabRightsManagerStore1="";b.$PageContentTabRightsManagerStore2="DEFAULT";b.$PageContentTabRightsManagerStore3=!1;b.$PageContentTabRightsManagerStore4=!1;b.$PageContentTabRightsManagerStore5=0;b.$PageContentTabRightsManagerStore6=0;return b}var d=c.prototype;d.init=function(a,b,c,d,e,f){this.$PageContentTabRightsManagerStore1=a,this.$PageContentTabRightsManagerStore2=b,this.$PageContentTabRightsManagerStore3=c,this.$PageContentTabRightsManagerStore4=d,this.$PageContentTabRightsManagerStore5=e,this.$PageContentTabRightsManagerStore6=f};d.getIsRMLite=function(){return this.$PageContentTabRightsManagerStore2==="LITE"};d.getIsRM4P=function(){return this.$PageContentTabRightsManagerStore2==="MUSIC_PUBLISHER"};d.setRMVersion=function(a){this.$PageContentTabRightsManagerStore2=a};d.getHasUploadedReferenceFiles=function(){return this.$PageContentTabRightsManagerStore3};d.getHasSetUpMatchSettings=function(){return this.$PageContentTabRightsManagerStore4};d.getUserAccessToken=function(){return this.$PageContentTabRightsManagerStore1};d.getNumVideosImported=function(){return this.$PageContentTabRightsManagerStore5};d.getTotalVideosToImport=function(){return this.$PageContentTabRightsManagerStore6};d.setHasUploadedReferenceFiles=function(){this.$PageContentTabRightsManagerStore3||(this.$PageContentTabRightsManagerStore3=!0,this.emit("change"))};d.setHasSetUpMatchSettings=function(){this.$PageContentTabRightsManagerStore4||(this.$PageContentTabRightsManagerStore4=!0,this.emit("change"),b("Arbiter").inform("reloadContentTabInBackground/"+b("PageContentTabConstants").TABS.ALL_REFERENCE_FILES))};d.setTotalVideosToImport=function(a){this.$PageContentTabRightsManagerStore6=a,this.emit("change")};d.setImportFinished=function(){this.$PageContentTabRightsManagerStore5=0,this.$PageContentTabRightsManagerStore6=0,this.emit("change")};return c}(b("EventEmitter"));e.exports=new a()}),null);
__d("RightsManagerFbt",["fbt"],(function(a,b,c,d,e,f,g){"use strict";e.exports={ALLOWED:g._("Allowed"),ATTRIBUTION_SECTION_TITLE:g._("Select Ownership Link"),ATTRIBUTION_SECTION_TITLE_LITE:g._("Destination Page"),BLOCKED:g._("Blocked"),CLAIMED:g._("Claimed"),INSIGHTS:g._("Details"),MATCHES:g._("Matches"),MANUAL_REVIEW:g._("Manual Review"),MONITORED:g._("Monitored"),OWNERSHIP_LINK:g._("Ownership Link"),MANUAL_CLAIMS:g._("Manual Claims"),PROTECTED_VIDEO:g._("Protected Videos"),PROTECTED_VIDEOS:g._("Protected Videos"),REMOVED:g._("Removed"),REPORTED:g._("Reported"),STATUS:g._("Status"),YOUR_FILE:g._("Your File")}}),null);
__d("VideoCopyrightMonitoringType",["fbt"],(function(a,b,c,d,e,f,g){a={VIDEO_AND_AUDIO:{intValue:1,value:"VIDEO_AND_AUDIO",label:g._("Video & Audio")},VIDEO_ONLY:{intValue:2,value:"VIDEO_ONLY",label:g._("Video Only")},AUDIO_ONLY:{intValue:3,value:"AUDIO_ONLY",label:g._("Audio Only")}};e.exports=a}),null);
__d("VideoCopyrightPublisherType",["fbt"],(function(a,b,c,d,e,f,g){a={PAGE:{value:"page",label:g._("Pages"),summaryLabel:g._("Pages")},PERSON:{value:"person",label:g._("Profiles"),summaryLabel:g._("Profiles")}};e.exports=a}),null);
__d("CopyrightReferenceFileGraphFields",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({CONTENT_TYPE:"content_type",DOWNLOAD_HD_URL:"download_hd_url",DURATION_IN_SEC:"duration_in_sec",ENCODING_STATUS:"encoding_status",ID:"id",LIVE_STATUS:"live_status",PUBLISHED_TIME:"published_time",COPYRIGHT_CREATION_TIME:"copyright_creation_time",THUMBNAIL_URL:"thumbnail_url",THUMBNAIL_URL_WHILE_ENCODING:"thumbnail_url_while_encoding",TITLE:"title",METADATA:"metadata",UNIVERSAL_CONTENT_ID:"universal_content_id",ISWC:"iswc",WRITER_NAMES:"writer_names",DISPLAY_ARTIST:"display_artist",SUB_TITLE:"sub_title",WHITELISTED_FB_IDS:"whitelisted_fb_ids",WHITELISTED_IG_IDS:"whitelisted_ig_ids"})}),null);
__d("XRightsManagerInstagramUserNameToIDController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/video/copyright/ig_user_name_to_id/",{page_id:{type:"FBID",required:!0},user_names:{type:"StringSet",required:!0}})}),null);
__d("IGUserDataFetcher",["regeneratorRuntime","AsyncRequest","XRightsManagerInstagramUserNameToIDController"],(function(a,b,c,d,e,f){"use strict";e.exports={gen:function(a,c){var d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:d=b("XRightsManagerInstagramUserNameToIDController").getURIBuilder().setFBID("page_id",c).setStringSet("user_names",a).getURI();return e.abrupt("return",new(b("AsyncRequest"))(d).setMethod("GET").setURI(d).setReadOnly(!0).exec());case 2:case"end":return e.stop()}},null,this)}}}),null);
__d("VideoCopyrightTrustedPartnerInfoGraphFields",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({CAN_CONFIRM_BLOCK:"can_confirm_block",CONFIRM_BLOCK_TIME:"confirm_block_time",CAN_CONFIRM_ACTION:"can_confirm_action",CONFIRM_ACTION_TIME:"confirm_action_time",IS_TRUSTED_PARTNER_MATCH:"is_trusted_partner_match",IS_FLAGGED_ENTITY_MATCH:"is_flagged_entity_match"})}),null);
__d("XVideoCopyrightMatchDialogController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/video/copyright/match/dialog/",{id:{type:"Int",required:!0},source:{type:"Enum",required:!0,enumType:1},__asyncDialog:{type:"Int"}})}),null);
__d("VideoCopyrightUtils",["ix","cx","fbt","invariant","regeneratorRuntime","ActorURI","AdsGenericFilter","AdsGenericFilterField","AdsGenericFilterFieldType","AdsGenericFilterSet","AsyncDialog","AsyncRequest","CopyrightReferenceFileGraphFields","GraphAPIFieldUtils","IGUserDataFetcher","Image.react","PageContentTabConstants","PageContentTabLogger","PageContentTabRightsManagerStore","React","RightsManagerFbt","TooltipData","VideoCopyrightGraphAPIVersion","VideoCopyrightMatchStatus","VideoCopyrightMonitoringType","VideoCopyrightPublisherType","VideoCopyrightRuleActionType","VideoCopyrightRuleGraphFields","VideoCopyrightSegmentSource","VideoCopyrightTrustedPartnerInfoGraphFields","VideoReferenceMatchState","XVideoCopyrightMatchDialogController","asset","fbglyph","joinClasses","parseISODate"],(function(a,b,c,d,e,f,g,h,i,j){"use strict";var k=b("React"),l=b("PageContentTabConstants").TABS,m=20,n=86400,o=3600,p=60,q=1e3,r={GRAPH_API_VERSION:b("VideoCopyrightGraphAPIVersion").graph_api_version,DEFAULT_MONITORING_TYPE:b("VideoCopyrightMonitoringType").VIDEO_ONLY.value,DEFAULT_LIVE_MONITORING_TYPE:b("VideoCopyrightMonitoringType").VIDEO_AND_AUDIO.value,DEFAULT_PUBLISHER_TYPE:b("VideoCopyrightPublisherType").PAGE.value,DEFAULT_RULE_ID:"DEFAULT",formatNumber:function(a){return a>=1e6?Math.round(a/1e6)+"M":a>=1e3?Math.round(a/1e3)+"K":a.toString()},getPremiumMusicVideoReleaseGraphAPIFields:function(){var a=["id","title","creation_time",b("GraphAPIFieldUtils").getFieldWithSubfields("premium_music_video_metadata",["id","type","audio_isrc","video_isrc","release_status_for_publishing","preferred_video_thumbnail_image_uri"]),b("GraphAPIFieldUtils").getFieldWithSubfields("release_info",["album_title","created_time","displayed_artist","label_name","audio_release_image_uri","original_release_date"])];return a},getPremiumMusicVideoReleaseDetailsGraphAPIFields:function(){var a=["id","title","creation_time","cross_post_videos","premium_music_video_metadata",b("GraphAPIFieldUtils").getFieldWithSubfields("release_info",["album_title","created_time","displayed_artist","label_name","audio_release_image_uri","original_release_date"])];return a},getAudioReleaseGraphAPIFields:function(a){a===void 0;a=["id","album_title","created_time","displayed_artist","ean","upc","grid","isrc","label_name","proprietary_id","parental_warning_type","genre","audio_release_image_uri","original_release_date"];a.push("availability_status");return a},apiToAvailabilityStatus:function(a){return a==null?null:{status:a.status,type:a.type,release:a.release,status_reasons:a.status_reasons}},apiToAssetAvailabilityStatus:function(a){if(a==null)return null;var b={};for(var c=0;c<a.length;c++){var d,e,f=a[c];e=(e=f)!=null?(e=e.value)!=null?e.asset_availability:e:e;d=(d=f)!=null?(d=d.value)!=null?d.availability_by_geo:d:d;var g={};for(var h=0;d!=null&&h<d.length;h++){var i,j=d[h];g[j.key]={status:(i=j)!=null?(i=i.value)!=null?i.status:i:i,type:(i=j)!=null?(i=i.value)!=null?i.type:i:i,release:(i=j)!=null?(i=i.value)!=null?i.release:i:i,status_reasons:(i=j)!=null?(i=i.value)!=null?i.status_reasons:i:i}}b[f.key]={asset_availability:e,availability_by_geo:g}}return b},getAvailableActionsForRMVersion:function(a){switch(a){case"MUSIC_PUBLISHER":case"MUSIC_LABEL":return[b("VideoCopyrightRuleActionType").MANUAL_REVIEW,b("VideoCopyrightRuleActionType").TRACK,b("VideoCopyrightRuleActionType").BLOCK];case"DEFAULT":return[b("VideoCopyrightRuleActionType").MANUAL_REVIEW,b("VideoCopyrightRuleActionType").TRACK,b("VideoCopyrightRuleActionType").BLOCK,b("VideoCopyrightRuleActionType").MONETIZE,b("VideoCopyrightRuleActionType").TAKEDOWN];case"LITE":return[b("VideoCopyrightRuleActionType").TRACK,b("VideoCopyrightRuleActionType").BLOCK,b("VideoCopyrightRuleActionType").TAKEDOWN];default:return[]}},getCopyrightAttributionGraphAPIFields:function(){return["id","title","creator","copyright_count","link_title","match_count","attribution_type","attribution_target_id","status","is_enabled","attribution_uri","creation_time","attribution_target_name"]},getGraphAPIFields:function(a){var c;c=["match_status","active_match_data_id","matched_video_asset","expiration_days",(c=b("GraphAPIFieldUtils")).getFieldWithSubfields("last_modified_user",["name"]),"last_modified_time","added_to_dashboard_time","is_viewed","notes","audit_log","applied_actions","sibling_applied_actions","action_requiring_manual_review","review_report_id",c.getFieldWithSubfields("match_data",["id","excluded_ownership_segments","video_copyright_id","video_matched_segments","audio_matched_segments","total_match_duration","primary_detection_method",c.getFieldWithSubfields("reference_asset",["content_type","download_hd_url","duration_in_sec","id","live_status","metadata","published_time","thumbnail_url","thumbnail_url_while_encoding","title","universal_content_id","iswc","writer_names","display_artist","copyright_creation_time","sub_title","whitelisted_fb_ids","whitelisted_ig_ids"]),"monitoring_type","match_rule","is_manual_match","applied_actions",c.getFieldWithSubfields("music_work_associated_audio_asset",["id","display_artist","download_hd_url","title","subtitle",c.getFieldWithSubfields("audio_isrc",["isrc"])])]),"is_anonymous","muted_segments_from_other_publishers","dispute","publisher_can_restore","matched_video_overlap_duration_in_sec","available_ui_actions","has_melody_match_data"];a.copyright_geo_actions_enabled&&c.push("ownership_countries");a.show_attributions_tab&&c.push(b("GraphAPIFieldUtils").getFieldWithSubfields("attribution",["title"]));(a.can_see_trusted_partner_match||a.can_see_flagged_entity_match)&&c.push(b("GraphAPIFieldUtils").getFieldWithSubfields("trusted_partner_info",Object.values(b("VideoCopyrightTrustedPartnerInfoGraphFields")).map(function(a){return String(a)})));a.can_see_is_business_page_match&&c.push("is_business_page_match");return c},getDefaultMatchRule:function(){var a={};a[b("VideoCopyrightRuleGraphFields").ID]=this.DEFAULT_RULE_ID;return a},getMatchGraphFields:function(){var a;return[(a=b("VideoCopyrightRuleGraphFields")).ID,a.NAME,a.CONDITION_GROUPS,a.CREATED_DATE,a.CREATOR,a.COPYRIGHTS_COUNT,a.MATCHES_COUNT,a.IS_IN_MIGRATION,a.IS_NEW_VERSION_RULE]},getFBPopularVideoSearchGraphFields:function(){return["id","created_time","title","description","thumbnails","post_views","from","length"]},getIGPopularVideoSearchGraphFields:function(){return["id","timestamp","caption","source","permalink","thumbnail_url","like_count","comments_count"]},getReferenceMatchGraphFields:function(){return["reference_asset","reference_owner_name","reference_owner_id","reference_copyright","matched_reference_asset","matched_reference_owner_id","matched_reference_owner_name","matched_reference_copyright",b("GraphAPIFieldUtils").getFieldWithSubfields("match_data",["id","excluded_ownership_segments","video_copyright_id","video_matched_segments","audio_matched_segments","original_video_matched_segments","original_audio_matched_segments","total_match_duration","reference_asset","monitoring_type","match_rule","is_manual_match","applied_actions"]),"conflicting_countries","match_state","creation_time","expiration_time","modification_history","dispute_form_data","rejection_form_data","is_viewed","is_disputable","is_possible_conflict"]},getReferenceFileGraphFields:function(a){a=["id","reference_owner_id","monitoring_type",b("GraphAPIFieldUtils").getFieldWithSubfields("attribution",["id","title","is_enabled","attribution_type","attribution_target_id","attribution_target_name"]),"ops_override_monitoring_type","reference_file_disabled_by_ops","reference_file_disabled","displayed_matches_count","displayed_fb_matches_count","displayed_ig_matches_count","copyright_content_id","rule_ids","whitelisted_ids","ownership_countries","monitoring_status","creator","in_conflict",b("GraphAPIFieldUtils").getFieldWithSubfields("reference_file",Object.values(b("CopyrightReferenceFileGraphFields")).map(function(a){return String(a)})),"reference_file_insights_key_id","content_category","excluded_ownership_segments"];return a},getSoundRecordingGraphFields:function(){return["id","isrc","creation_time","displayed_matches_count","reference_file_status","ridge_monitoring_status",b("GraphAPIFieldUtils").getFieldWithSubfields("audio_asset",["title","subtitle","display_artist","duration_in_ms"])]},getMusicWorkGraphFields:function(){return["id","creation_time","status",b("GraphAPIFieldUtils").getFieldWithSubfields("music_work",["id","custom_id","iswc","title"])]},getMusicVideoGraphFields:function(){return["id","isrc","creation_time","displayed_matches_count","reference_file_status","ridge_monitoring_status",b("GraphAPIFieldUtils").getFieldWithSubfields("video_asset",["title","thumbnail_url","duration_in_sec"])]},getDeletedVideoAsset:function(){var a={};a.title=i._("Deleted");a.published_time=0;a.thumbnail_url="";a.duration_in_sec=0;a.description="";a.owner_name="";a.view_count=0;a.is_private=!1;return a},_getTabFromMatchStatus:function(a,c){switch(a){case b("VideoCopyrightMatchStatus").REMOVED:return l.TAKEDOWNS;case b("VideoCopyrightMatchStatus").REPORTED:return b("PageContentTabRightsManagerStore").getIsRMLite()?l.TAKEDOWNS:l.REPORTED;case b("VideoCopyrightMatchStatus").ALLOWED:return l.TRACKED;case b("VideoCopyrightMatchStatus").ADDED_MATCH:return l.UNSENT_REPORTS;case b("VideoCopyrightMatchStatus").BLOCKED:return l.BLOCKED;case b("VideoCopyrightMatchStatus").CLAIMED:return l.CLAIMED;case b("VideoCopyrightMatchStatus").MONITORED:return l.TRACKED;default:return l.MANUAL_REVIEW}},logDataError:function(a,c,d){d=r._getTabFromMatchStatus(a.match_status,d);b("PageContentTabLogger").log("data_error",d,{error:JSON.stringify(c),post_id:a.id})},logAPIError:function(a,c,d,e){a=r._getTabFromMatchStatus(a,e);b("PageContentTabLogger").log("api_error",a,{error:c+" : "+JSON.stringify(d)})},isMajorityUnseen:function(a){var b=0;a.forEach(function(a){a.is_viewed?b+=1:b-=1});return b<0},getMatchedOwnerFilter:function(a){var c=new(b("AdsGenericFilterField"))("static_matched_owner_id",b("AdsGenericFilterFieldType").STRING_SET);a=a.matched_video_asset;a=a.owner_name;a.length>m&&(a=a.substring(0,m));return new(b("AdsGenericFilterSet"))([new(b("AdsGenericFilter"))(c,"CONTAIN",a)])},getActiveMatchDataFromMatch:function(a){var b=a.match_data,c=a.active_match_data_id;a=b.filter(function(a){return c==a.id});if(a.length===1)return a[0];else return b[0]},getReferenceVideoFilter:function(a){a=this.getActiveMatchDataFromMatch(a);var c=new(b("AdsGenericFilterField"))("static_reference_video_id",b("AdsGenericFilterFieldType").STRING_SET);a=a.reference_asset;return new(b("AdsGenericFilterSet"))([new(b("AdsGenericFilter"))(c,"EQUAL",a.id)])},getCopyrightInUnixDateFormat:function(a,c){a=a;var d=a.reference_file,e=d.published_time;e=b("parseISODate")(e);d.published_time=e.getTime()/1e3;e=d.live_status===0;var f=d.encoding_status;f=f&&f.video_status==="processing";c&&e&&f&&(d.live_status=1);return a},openMatchComparisonDialog:function(a,c){a=b("ActorURI").create(b("XVideoCopyrightMatchDialogController").getURIBuilder().setInt("id",a).setEnum("source","dashboard").getURI(),c);b("AsyncDialog").send(new(b("AsyncRequest"))(a))},sortableColumnToField:function(a,c){var d=this.getActiveMatchDataFromMatch(c);switch(a){case b("PageContentTabConstants").COLUMNS.VIDEO_VIEWS:return c.matched_video_asset.view_count;case b("PageContentTabConstants").COLUMNS.OVERLAP:return d.total_match_duration;case b("PageContentTabConstants").COLUMNS.EXPIRES_DAYS:case b("PageContentTabConstants").COLUMNS.DISPUTE_EXPIRES_DAYS:return c.expiration_days;case b("PageContentTabConstants").COLUMNS.REFERENCE_VIDEO:return d.reference_asset.title;case b("PageContentTabConstants").COLUMNS.LAST_MODIFIED_BY:return c.last_modified_time;case b("PageContentTabConstants").COLUMNS.DATE_FOUND:return c.added_to_dashboard_time}j(0,3678)},convertGraphAPIAssetToVideoCopyrightVideoMetadata:function(a){if(!a)return null;var b=a.ad_break_offsets_in_ms;return{id:a.id,title:a.title,durationInSec:a.duration_in_sec,width:a.width,height:a.height,permalinkURL:a.permalink_url,thumbnailSrc:a.thumbnail_url,ownerID:a.owner_id,ownerIsVerified:a.owner_is_verified,ownerPictureSrc:a.owner_picture_url,ownerPublicName:a.owner_name||"",ownerProfileURL:a.owner_url,publishedTime:a.published_time,isPrivate:a.is_private,description:a.description,viewsCount:a.view_count,commentsCount:a.comment_count,sharesCount:a.share_count,followersCount:a.followers_count,likesCount:a.like_count,liveStatus:a.live_status,privacyExplanation:a.privacy_explanation,adBreakOffsets:b,containsAdBreaks:b&&b.length>0,monetizingOwnerCount:a.monetizing_owner_count,platform:a.platform,isStory:a.is_story,storyExpirationHours:a.story_expiration_hours,videoId:a.video_id,referenceMatchAssetType:"VIDEO"}},getDefaultReferenceFileType:function(){return{id:"",title:"",durationInSec:0,thumbnailSrc:"",liveStatus:2,contentType:"video",metadata:{},universalContentID:"",publishedTime:0}},convertGraphAPIAssetToReferenceFileMetadata:function(a){return!a?this.getDefaultReferenceFileType():{id:a.id,title:a.title,downloadHdUrl:a.download_hd_url,durationInSec:a.duration_in_sec,thumbnailSrc:a.thumbnail_url,liveStatus:a.live_status,contentType:a.content_type,metadata:a.metadata,publishedTime:a.published_time,universalContentID:a.universal_content_id,iswc:a.iswc,writer_names:a.writer_names,copyrightCreationTime:a.copyright_creation_time,subTitle:a.sub_title,referenceMatchAssetType:"VIDEO",whitelistedFBIDs:a.whitelisted_fb_ids,whitelistedIGIDs:a.whitelisted_ig_ids}},convertGraphAPIAuditLogToVideoMetadata:function(a){var b=[];a.forEach(function(a){b.push({userName:a.user_name,timestamp:a.timestamp,matchState:a.match_state,reason:a.reason,appliedActions:a.applied_actions||[]})});return b},convertGraphAPIDisputeToMetadata:function(a){return{id:a.id,disputeType:a.dispute_type,status:a.status,expirationTime:a.expiration_time,timeCreated:a.time_created,timeAppealed:a.time_appealed,timeUpdated:a.time_updated,disputeFormData:a.dispute_form_data,disputeFormExplanationTranslation:a.dispute_form_explanation_translation,appealFormData:a.appeal_form_data,appealFormExplanationTranslation:a.appeal_form_explanation_translation,vertical:"video"}},convertGraphAPIMatchToVideoCopyrightMatch:function(a){var b=a.matched_video_asset,c=a.last_modified_user,d=a.audit_log,e=a.dispute,f=a.muted_segments_from_other_publishers;return{attribution:a.attribution,matchID:a.id,is_viewed:a.is_viewed,status:a.match_status,expirationInDays:a.expiration_days,matchedVideoAsset:b?this.convertGraphAPIAssetToVideoCopyrightVideoMetadata(b):null,lastModifiedUserName:c?c.name:" ",lastModifiedTime:a.last_modified_time,auditLog:d?this.convertGraphAPIAuditLogToVideoMetadata(d):null,notes:a.notes,appliedActions:a.applied_actions||[],siblingAppliedActions:a.sibling_applied_actions||[],dispute:e?this.convertGraphAPIDisputeToMetadata(e):null,actionRequiringManualReview:a.action_requiring_manual_review,matchData:this.convertGraphAPIMatchDataToMetadata(a),addedToDashboardTime:a.added_to_dashboard_time,reviewReportID:a.review_report_id,ownershipCountries:a.ownership_countries,isAnonymous:a.is_anonymous,matchedAssetPlatform:b?b.platform:"FB",mutedSegmentsFromOtherPublishers:this.convertGraphAPIMutedSegmentsFromOtherPublishers(f),trustedPartnerInfo:a.trusted_partner_info,isBusinessPageMatch:a.is_business_page_match,publisherCanRestore:a.publisher_can_restore,matchedVideoOverlapDurationInSec:a.matched_video_overlap_duration_in_sec,hasMelodyMatchData:a.has_melody_match_data}},convertGraphAPIMutedSegmentsFromOtherPublishers:function(a){var b=[];if(!a)return b;a.forEach(function(a){var c=a.publisher_name,d=a.start_time_in_sec,e=a.duration_in_sec;a=a.segment_source;b.push({publisherName:c,startTimeInSec:d,durationInSec:e,segmentSource:a})});return b},convertGraphAPIReferenceHistoryToMetadata:function(a){var b=[];if(!a)return b;a.forEach(function(a){b.push({timestamp:a.timestamp,matchState:a.match_state})});return b},convertGraphAPIMatchToVideoReferenceMatch:function(a,b){b=b==a.matched_reference_owner_id;var c=b?a.matched_reference_copyright:a.reference_copyright;return{id:a.id,history:this.convertGraphAPIReferenceHistoryToMetadata(a.modification_history),matchState:a.match_state,matchData:this.convertGraphAPIMatchDataToMetadataImpl(a.match_data),matchedAsset:a.matched_reference_asset?this.convertGraphAPIAssetToReferenceFileMetadata(a.matched_reference_asset):null,referenceAsset:a.reference_asset?this.convertGraphAPIAssetToReferenceFileMetadata(a.reference_asset):null,matchedReferenceOwnerID:a.matched_reference_owner_id,matchedReferenceOwnerName:a.matched_reference_owner_name,referenceOwnerID:a.reference_owner_id,referenceOwnerName:a.reference_owner_name,conflictingCountries:a.conflicting_countries,ownershipCountries:c?c.ownership_countries:null,disputeFormData:JSON.parse(a.dispute_form_data),rejectionFormData:JSON.parse(a.rejection_form_data),expirationTime:a.expiration_time,isDisputable:a.is_disputable,isMatchedOwner:b,isPossibleConflict:a.is_possible_conflict,matchedReferenceCopyrightID:(c=a)!=null?(c=c.matched_reference_copyright)!=null?c.id:c:c,referenceCopyrightID:(b=a)!=null?(b=b.matched_reference_copyright)!=null?b.id:b:b}},convertGraphAPIMatchDataToMetadata:function(a){var b=a.match_data,c=[];b&&b.length&&b.forEach(function(b){var d=r.convertGraphAPIMatchDataToMetadataImpl(b);b.id.toString()===a.active_match_data_id?c.unshift(d):c.push(d)});return c},convertMatchedSegmentsToCopyrightSegments:function(a,c,d){a=a[c?d?"original_video_matched_segments":"video_matched_segments":d?"original_audio_matched_segments":"audio_matched_segments"]||[];c=a.map(function(a){return{referenceStartTimeInSec:a.reference_start_time_in_sec,matchedStartTimeInSec:a.matched_start_time_in_sec,durationInSec:a.duration_in_sec,refDurationInSec:a.ref_duration_in_sec,errorType:a.error_type,mediaType:a.media_type,segmentSource:a.segment_source||b("VideoCopyrightSegmentSource").RIDGE_MATCHES,included:!0}});return c},convertExcludedSegmentsToCopyrightSegments:function(a){a=a.map(function(a){return{referenceStartTimeInSec:a.start_time_in_sec,matchedStartTimeInSec:a.start_time_in_sec,durationInSec:a.duration_in_sec,refDurationInSec:a.duration_in_sec,mediaType:a.media_type,included:!!a.included,segmentSource:b("VideoCopyrightSegmentSource").PUBLISHER_DEFINED}});return a},convertCopyrightSegmentsToExcludedSegments:function(a){var c=[];a.forEach(function(a){if(a.segmentSource!==b("VideoCopyrightSegmentSource").PUBLISHER_DEFINED)return;a={start_time_in_sec:a.referenceStartTimeInSec,duration_in_sec:a.durationInSec,media_type:a.mediaType,segment_source:a.segmentSource,included:!!a.included};c.push(a)});return c},convertGraphAPIMatchDataToMetadataImpl:function(a){var b=a.excluded_ownership_segments||[];return{id:a.id,excludedSegments:this.convertExcludedSegmentsToCopyrightSegments(b),monitoringType:a.monitoring_type,appliedActions:a.applied_actions,matchRule:a.match_rule,matchedDurationInSec:a.total_match_duration,videoSegments:this.convertMatchedSegmentsToCopyrightSegments(a,!0,!1),audioSegments:this.convertMatchedSegmentsToCopyrightSegments(a,!1,!1),originalVideoSegments:this.convertMatchedSegmentsToCopyrightSegments(a,!0,!0),originalAudioSegments:this.convertMatchedSegmentsToCopyrightSegments(a,!1,!0),referenceAsset:this.convertGraphAPIAssetToReferenceFileMetadata(a.reference_asset),isManualMatch:a.is_manual_match,videoCopyrightID:a.video_copyright_id,musicWorkAssociatedAudioAsset:a.music_work_associated_audio_asset,assetType:"VIDEO",detectionMethod:a.primary_detection_method}},getExpirationLabelFromExpirationTime:function(a){var b,c;a=a-Date.now()/q;a<o?(b=Math.ceil(a/p),c=b===1?"minute":"minutes"):a<n?(b=Math.ceil(a/o),c=b===1?"hour":"hours"):(b=Math.ceil(a/n),c=b===1?"day":"days");if(b<0)return null;else return i._({"*":{"day":"{time before expiration} day","days":"{time before expiration} days","hour":"{time before expiration} hour","hours":"{time before expiration} hours","minute":"{time before expiration} minute","minutes":"{time before expiration} minutes"}},[i._param("time before expiration",b,[0]),i._enum(c,{day:"day",days:"days",hour:"hour",hours:"hours",minute:"minute",minutes:"minutes"})])},getIsReferenceMatchStateActionable:function(a,c){return c===b("VideoReferenceMatchState").CONFLICT||c===b("VideoReferenceMatchState").DISPUTED||c===b("VideoReferenceMatchState").POSSIBLE_CONFLICT||a&&c===b("VideoReferenceMatchState").DISPUTE_REJECTED},getIsPassiveReferenceResolution:function(a,c){if(a)return c===b("VideoReferenceMatchState").CONFLICT_EXPIRED||c===b("VideoReferenceMatchState").DISPUTE_REJECTED;else return c===b("VideoReferenceMatchState").DISPUTE_EXPIRED},getAppliedActionLabel:function(a){a=a.map(function(a){return a.action});var c=a.indexOf(b("VideoCopyrightRuleActionType").BLOCK)!==-1;if(c)return b("RightsManagerFbt").BLOCKED;c=a.indexOf(b("VideoCopyrightRuleActionType").MONETIZE)!==-1;if(c)return i._("Claim ad earnings");c=a.indexOf(b("VideoCopyrightRuleActionType").TRACK)!==-1;return c?b("RightsManagerFbt").MONITORED:b("RightsManagerFbt").CLAIMED},getActionRequiringManualReviewLabel:function(a){switch(a){case b("VideoCopyrightRuleActionType").BLOCK:return i._("Block not applied");case b("VideoCopyrightRuleActionType").MONETIZE:return i._("Claim ad earnings not applied");default:return i._("Manually review")}},getReferenceMatchStateLabel:function(a,c){switch(a){case b("VideoReferenceMatchState").CONFLICT:case b("VideoReferenceMatchState").POSSIBLE_CONFLICT:return i._("Conflict detected");case b("VideoReferenceMatchState").OWNERSHIP_ASSERTED:return i._("Ownership asserted");case b("VideoReferenceMatchState").DISPUTED:return c?i._("Dispute submitted"):i._("Ownership disputed");case b("VideoReferenceMatchState").DISPUTE_ACCEPTED:return c?i._("Dispute accepted"):i._("Dispute accepted by you");case b("VideoReferenceMatchState").DISPUTE_REJECTED:return c?i._("Dispute rejected"):i._("Dispute rejected by you");case b("VideoReferenceMatchState").CONFLICT_RESOLVED:return i._("Conflict resolved");case b("VideoReferenceMatchState").CONFLICT_EXPIRED:return i._("Conflict expired");case b("VideoReferenceMatchState").DISPUTE_EXPIRED:return c?i._("Dispute accepted"):i._("Dispute expired");default:return i._("Unknown")}},getShouldShowReferenceMatchExpirationTime:function(a,c){return c?a===b("VideoReferenceMatchState").CONFLICT||a===b("VideoReferenceMatchState").POSSIBLE_CONFLICT:a===b("VideoReferenceMatchState").DISPUTED},getReferenceMatchExpirationTooltip:function(a,c,d,e){if(c){if(a===b("VideoReferenceMatchState").CONFLICT||a===b("VideoReferenceMatchState").POSSIBLE_CONFLICT)return null}else if(a===b("VideoReferenceMatchState").DISPUTED)return null;return i._("{conflicting publisher} has {time before expiration} to respond to your dispute. You'll be notified when they respond.",[i._param("conflicting publisher",e),i._param("time before expiration",d)])},logToPageContentTabLoggerWithDetails:function(a,c,d){b("PageContentTabLogger").log("action_taken_main_view",d,{page_id:c,action:a})},renderOldVersionRuleIndicator:function(a,c){return c?null:k.jsx(b("Image.react"),{className:b("joinClasses")(a,"_5u-h"),"data-tooltip-content":i._("This match rule needs to be replaced with a new match rule due to recent updates. Assign reference files associated with it to a different or new match rule."),"data-hover":"tooltip","data-tooltip-position":"right",src:g("132175")})},dedupeSegments:function(a,b){var c=0,d=[],e=null;a.sort(function(a,c){a=b?a.referenceStartTimeInSec:a.matchedStartTimeInSec;c=b?c.referenceStartTimeInSec:c.matchedStartTimeInSec;return a>c?1:-1}).forEach(function(a){var f=a.durationInSec,g=b?a.referenceStartTimeInSec:a.matchedStartTimeInSec;f=g+f;if(e&&g<c){e.durationInSec+=Math.max(0,f-c);c=Math.max(c,f);return}g=babelHelpers["extends"]({},a);e=g;d.push(g);c=Math.max(c,f)});return d},convertIGUserNameToIDs:function(a,c){var d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:if(!(c.length===0)){e.next=2;break}return e.abrupt("return",[]);case 2:e.next=4;return b("regeneratorRuntime").awrap(b("IGUserDataFetcher").gen(c,a));case 4:d=e.sent;return e.abrupt("return",Object.values(d.payload));case 6:case"end":return e.stop()}},null,this)},getMatchedOwnerBadge:function(a,c){if(a)return k.jsx(b("Image.react"),babelHelpers["extends"]({className:"_4gyc",src:g("540419")},b("TooltipData").propsFor(i._("Trusted partner"),"above")));return c?k.jsx(b("Image.react"),babelHelpers["extends"]({className:"_4gyc",src:g("499172")},b("TooltipData").propsFor(i._("This Page identifies as a business"),"above"))):null},getGeoActionReasonName:function(a){switch(a){case"unauthorized_commercial_use":return i._("Unauthorized Commercial Use");case"restricted_content":return i._("Restricted Content");case"objectionable_content":return i._("Objectionable Content");case"artist_objection":return i._("Artist Objection");case"prerelease_content":return i._("Pre-release Content");case"product_parameters":return i._("Product Parameters");case"premium_music_video":return i._("Premium Music Video");default:return null}},getGeoActionReasonTootip:function(a){switch(a){case"unauthorized_commercial_use":return i._("Includes recordings that are not licensed for business use");case"restricted_content":return i._("Includes recordings from restricted artists or restricted writers");case"objectionable_content":return i._("Includes violence, pornography or other objectionable content");case"artist_objection":return i._("Includes content that the artist has a formal objection to");case"prerelease_content":return i._("Includes recordings that have not been officially released");case"product_parameters":return i._("A type of video that isn't included in your license (still image video, DJ mix, streaming service or other restricted format)");case"premium_music_video":return i._("Includes any part of a premium music video");default:return null}},getGeoActionReasonList:function(){return["unauthorized_commercial_use","restricted_content","objectionable_content","artist_objection","prerelease_content","product_parameters","premium_music_video"]},getGeoActionReasonListMMRM:function(a){var b=["unauthorized_commercial_use","restricted_content","objectionable_content","artist_objection","prerelease_content","product_parameters"];a==="MUSIC_LABEL"&&b.push("premium_music_video");return b}};e.exports=r}),null);
__d("VideoPlayerControllerStore",["FluxMapStore","SphericalVideoComponentActions","SphericalVideoComponentConstants","SphericalVideoComponentDispatcher","VideoPlayerReasonTransitionHelper","curry","immutable"],(function(a,b,c,d,e,f){"use strict";var g=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.apply(this,arguments)||this}return a}(b("immutable").Record({currentTime:-1,currentVideoPlayerState:"unknown",durationSeconds:-1,videoId:""}));a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var c,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=d=a.call.apply(a,[this].concat(f))||this,d.onVideoPlayerControllerStateChange=function(a){var c=a.getVideoPlayerID(),e=d.$VideoPlayerControllerStore6(d.getState(),c);e=e.videoPlayerState;a=a.getState();e!==a&&b("SphericalVideoComponentActions").updateVideoPlayerState(c,a)},c)||babelHelpers.assertThisInitialized(d)}var d=c.prototype;d.getInitialState=function(){return b("immutable").Map({videoPlayerControllers:b("immutable").Map({}),videoPlayerControllerStates:b("immutable").Map({})})};d.reduce=function(a,c){var d=c.id;switch(c.type){case b("SphericalVideoComponentConstants").ACTIONS.REGISTER_VIDEO_PLAYER_CONTROLLER:var e=c.controller;a=this.$VideoPlayerControllerStore1(a,e,d);break;case b("SphericalVideoComponentConstants").ACTIONS.UPDATE_VIDEO_PLAYER_STATE:a=this.$VideoPlayerControllerStore2(a,d,c.state);break;case b("SphericalVideoComponentConstants").ACTIONS.TOGGLE_PLAY:a=this.$VideoPlayerControllerStore3(a,d,c.nextIsPlaying);break;case b("SphericalVideoComponentConstants").ACTIONS.SET_CURRENT_PLAY_TIME:a=this.$VideoPlayerControllerStore4(a,d,c.time);break;case b("SphericalVideoComponentConstants").ACTIONS.SET_VIDEO_DURATION:a=this.$VideoPlayerControllerStore5(a,d,c.durationSeconds);break;default:break}return a};d.getVideoPlayerController=function(a){var b=this.get("videoPlayerControllers");if(b&&b.has(a))return b.get(a);else throw new Error("Video player controller with id "+a+" is not registered")};d.getIsVideoPlayable=function(a){a=this.$VideoPlayerControllerStore6(this.getState(),a).currentVideoPlayerState;return a!=="fallback"&&a!=="destroyed"&&a!=="unknown"};d.getIsPlaying=function(a){var b=this.getVideoPlayerController(a).isBuffering();a=this.$VideoPlayerControllerStore6(this.getState(),a).currentVideoPlayerState;return a==="playing"&&!b};d.getCurrentTime=function(a){return this.$VideoPlayerControllerStore6(this.getState(),a).currentTime};d.getVideoID=function(a){return this.$VideoPlayerControllerStore6(this.getState(),a).videoId};d.$VideoPlayerControllerStore1=function(a,c,d){var e=a.get("videoPlayerControllers");if(e.has(d))return a;e=e.set(d,c);a=a.set("videoPlayerControllers",e);e=a.get("videoPlayerControllerStates");var f=new g({isPlaying:c.isState("playing"),currentTime:c.getCurrentTimePosition(),videoId:c.getVideoID()});e=e.set(d,f);a=a.set("videoPlayerControllerStates",e);c.addListener("stateChange",b("curry")(this.onVideoPlayerControllerStateChange,c));c.addListener("updateStatus",b("curry")(this.onTimeUpdate,c));c.addListener("updateMetadata",b("curry")(this.onUpdateMetaData,c));c.addListener("VideoChannelController/pendingElementsShown",b("curry")(this.onToggleChannelView,c,!0));c.addListener("VideoChannelController/exitChannel",b("curry")(this.onToggleChannelView,c,!1));c.addListener("seekRequested",b("curry")(this.onSeekStart,c));c.addListener("TahoeController/enterTahoe",b("curry")(this.onToggleTahoe,c,!0));c.addListener("TahoeController/exitTahoe",b("curry")(this.onToggleTahoe,c,!1));return a};d.onTimeUpdate=function(a,c){b("SphericalVideoComponentActions").setCurrentVideoTime(a.getVideoPlayerID(),c.position)};d.onSeekStart=function(a){b("SphericalVideoComponentActions").seekStart(a.getVideoPlayerID())};d.onUpdateMetaData=function(a){b("SphericalVideoComponentActions").setVideoDuration(a.getVideoPlayerID(),a.getPlaybackDuration())};d.onToggleChannelView=function(a,c){b("SphericalVideoComponentActions").toggleChannelView(a.getVideoPlayerID(),c)};d.onToggleTahoe=function(a,c){b("SphericalVideoComponentActions").toggleTahoe(a.getVideoPlayerID(),c)};d.$VideoPlayerControllerStore3=function(a,c,d){var e=this.getVideoPlayerController(c);c=this.$VideoPlayerControllerStore6(this.getState(),c);c=c.currentVideoPlayerState;(c==="playing"&&!d||c==="paused"&&d)&&(d?e.play(new(b("VideoPlayerReasonTransitionHelper"))("user_initiated")):e.pause());return a};d.$VideoPlayerControllerStore4=function(a,b,c){return this.$VideoPlayerControllerStore7(a,b,"currentTime",c)};d.$VideoPlayerControllerStore2=function(a,b,c){return this.$VideoPlayerControllerStore7(a,b,"currentVideoPlayerState",c)};d.$VideoPlayerControllerStore5=function(a,b,c){return this.$VideoPlayerControllerStore7(a,b,"durationSeconds",c)};d.$VideoPlayerControllerStore6=function(a,b){a=a.get("videoPlayerControllerStates").get(b);a||this.$VideoPlayerControllerStore8(b);return a};d.$VideoPlayerControllerStore7=function(a,b,c,d){var e=a.get("videoPlayerControllerStates"),f=this.$VideoPlayerControllerStore6(a,b);f=f.set(c,d);e=e.set(b,f);return a.set("videoPlayerControllerStates",e)};d.$VideoPlayerControllerStore8=function(a){throw new Error("Video player controller with id "+a+" does not exist")};return c}(b("FluxMapStore"));a.__moduleID=e.id;e.exports=new a(b("SphericalVideoComponentDispatcher"))}),null);
__d("CDSFallback.fs",[],(function(a,b,c,d,e,f){e.exports="\n  varying highp vec2 vTextureCoord;\n  varying highp vec3 vPos;\n  varying lowp float vRecompute;\n\n  uniform highp vec2 uOffset;\n  uniform sampler2D uSampler;\n\n  highp vec2 EquirectPart( highp vec3 p )\n  {\n    highp float xz = sqrt( p.x * p.x + p.z * p.z );\n    highp float lat = -atan( p.y, xz );\n    highp float t = lat / 1.57079633 / 1.01 + 0.5;\n    highp float s = atan( p.x, -p.z ) / 1.01 / (2.5 * 3.1415927) + 0.4;\n    highp vec2 st = vec2(s, t);\n    return st;\n  }\n\n  highp vec2 FacePart( highp vec3 p )\n  {\n      highp vec2 t = p.xz / p.y;\n      highp float s = sign(p.y);\n      return vec2(0.9 + t.x * s * 0.099009901,\n          0.5 - s * 0.25 - t.y * 0.247524752);\n  }\n\n  void main()\n  {\n    if (vRecompute > 0.0) {\n      highp vec3 v = normalize( vPos );\n      highp float d = length( v.xz );\n      highp vec2 t = normalize(v.xz / d + uOffset) * d;\n      v = vec3(t.x, v.y, t.y);\n      highp vec2 o;\n      if ( abs(v.y) < 0.707106781 ) {\n        o = EquirectPart( v );\n      } else {\n        o = FacePart( v );\n      }\n      gl_FragColor = texture2D( uSampler, o );\n    } else {\n      gl_FragColor = texture2D( uSampler, vTextureCoord );\n    }\n  }\n"}),null);
__d("CDSFallback.vs",[],(function(a,b,c,d,e,f){e.exports="\n  attribute vec3 aVertexPosition;\n\n  // It's actually inverse MV matrix\n  uniform mat4 uMVMatrix;\n  uniform mat4 uPMatrix;\n  uniform highp vec2 uOffset;\n\n  varying highp vec2 vTextureCoord;\n  varying highp vec3 vPos;\n  varying lowp float vRecompute;\n\n  highp vec2 EquirectPart( highp vec3 p )\n  {\n    highp float xz = sqrt( p.x * p.x + p.z * p.z );\n    highp float lat = -atan( p.y, xz );\n    highp float t = lat / 1.57079633 / 1.01 + 0.5;\n    highp float s = atan( p.x, -p.z ) / 1.01 / (2.5 * 3.1415927) + 0.4;\n    highp vec2 st = vec2(s, t);\n    return st;\n  }\n  highp vec2 FacePart( highp vec3 p )\n  {\n      highp vec2 t = p.xz / p.y;\n      highp float s = sign(p.y);\n      return vec2(0.9 + t.x * s * 0.099009901,\n          0.5 - s * 0.25 - t.y * 0.247524752);\n  }\n\n  const float eps = 0.03;\n\n  void main(void) {\n    gl_Position = uPMatrix * vec4(aVertexPosition, 1.0);\n    vPos = (uMVMatrix * vec4(aVertexPosition, 1.0)).xyz;\n    highp vec3 v = normalize( vPos );\n    highp float d = length( v.xz );\n    highp vec2 t = normalize(v.xz / d + uOffset) * d;\n    v = vec3(t.x, v.y, t.y);\n    vRecompute = 0.0;\n    if ( abs(v.y) < 0.707106781 ) {\n      vTextureCoord = EquirectPart( v );\n      vRecompute += float( vTextureCoord.x < eps * 0.5 ||\n          vTextureCoord.x > 0.8 - eps * 0.5 );\n    } else {\n      vTextureCoord = FacePart( v );\n      vRecompute += float( abs(v.y) > 1.0 - eps );\n    }\n    vRecompute += float( abs(v.y) < 0.707106781 + eps &&\n        abs(v.y) > 0.707106781 - eps );\n  }\n"}),null);
__d("CDSRenderer.fs",[],(function(a,b,c,d,e,f){e.exports="\n  varying highp vec2 vTextureCoord;\n  varying highp vec3 vPos;\n  varying lowp float vRecompute;\n  varying highp vec2 vOffset;\n\n  uniform sampler2D uSampler;\n\n  highp vec2 EquirectPart( highp vec3 p )\n  {\n    highp float xz = sqrt( p.x * p.x + p.z * p.z );\n    highp float lat = -atan( p.y, xz );\n    highp float t = lat / 1.57079633 / 1.01 + 0.5;\n    highp float s = atan( p.x, -p.z ) / 1.01 / (2.5 * 3.1415927) + 0.4;\n    highp vec2 st = vec2(s, t);\n    return st;\n  }\n\n  highp vec2 FacePart( highp vec3 p )\n  {\n      highp vec2 t = p.xz / p.y;\n      highp float s = sign(p.y);\n      return vec2(0.9 + t.x * s * 0.099009901,\n          0.5 - s * 0.25 - t.y * 0.247524752);\n  }\n\n  void main()\n  {\n    if (vRecompute > 0.0) {\n      highp vec3 v = normalize( vPos );\n      highp float d = length( v.xz );\n      highp vec2 t = normalize(v.xz / d + vOffset) * d;\n      v = vec3(t.x, v.y, t.y);\n      highp vec2 o;\n      if ( abs(v.y) < 0.707106781 ) {\n        o = EquirectPart( v );\n      } else {\n        o = FacePart( v );\n      }\n      gl_FragColor = texture2D( uSampler, o );\n    } else {\n      gl_FragColor = texture2D( uSampler, vTextureCoord );\n    }\n  }\n"}),null);
__d("CDSRenderer.vs",[],(function(a,b,c,d,e,f){e.exports="\n  attribute vec3 aVertexPosition;\n\n  uniform sampler2D uSampler;\n  // It's actually inverse MV matrix\n  uniform mat4 uMVMatrix;\n  uniform mat4 uPMatrix;\n\n  varying highp vec2 vTextureCoord;\n  varying highp vec3 vPos;\n  varying lowp float vRecompute;\n  varying highp vec2 vOffset;\n\n  highp vec2 EquirectPart( highp vec3 p )\n  {\n    highp float xz = sqrt( p.x * p.x + p.z * p.z );\n    highp float lat = -atan( p.y, xz );\n    highp float t = lat / 1.57079633 / 1.01 + 0.5;\n    highp float s = atan( p.x, -p.z ) / 1.01 / (2.5 * 3.1415927) + 0.4;\n    highp vec2 st = vec2(s, t);\n    return st;\n  }\n\n  highp vec2 FacePart( highp vec3 p )\n  {\n      highp vec2 t = p.xz / p.y;\n      highp float s = sign(p.y);\n      return vec2(0.9 + t.x * s * 0.099009901,\n          0.5 - s * 0.25 - t.y * 0.247524752);\n  }\n\n  highp vec4 extractFromSample(highp vec4 c)\n  {\n    highp float minC = min(0.5, min(c.r, min(c.g, c.b)));\n    highp float diffC = max(0.5, max(c.r, max(c.g, c.b))) - minC + 0.001;\n    return step(0.5, (c - minC) / diffC);\n  }\n\n  highp vec2 parseOffset()\n  {\n    highp float calculated_offsetX, calculated_offsetZ;\n    highp float offset_v, offset_e, offset_sig; // temp variables\n    highp vec4 texCoordsX[7], texCoordsZ[7]; // constants\n\n    texCoordsX[0] = extractFromSample(texture2D(uSampler, vec2(0.396, 1.0)));\n    texCoordsX[1] = extractFromSample(texture2D(uSampler, vec2(0.404, 1.0)));\n    texCoordsX[2] = extractFromSample(texture2D(uSampler, vec2(0.412, 1.0)));\n    texCoordsX[3] = extractFromSample(texture2D(uSampler, vec2(0.420, 1.0)));\n    texCoordsX[4] = extractFromSample(texture2D(uSampler, vec2(0.428, 1.0)));\n    texCoordsX[5] = extractFromSample(texture2D(uSampler, vec2(0.436, 1.0)));\n    texCoordsX[6] = extractFromSample(texture2D(uSampler, vec2(0.444, 1.0)));\n\n    offset_v = texCoordsX[0].r * 0.0009765625\n      + dot(texCoordsX[1].bgr, vec3(0.001953125, 0.00390625, 0.0078125))\n      + dot(texCoordsX[2].bgr, vec3(0.015625, 0.03125, 0.0625))\n      + dot(texCoordsX[3].bgr, vec3(0.125, 0.25, 0.5))\n      + 1.0;\n\n    offset_e = dot(texCoordsX[4].bgr, vec3(1.0, 2.0, 4.0))\n      + dot(texCoordsX[5].bgr, vec3(8.0, 16.0, 32.0))\n      + dot(texCoordsX[6].bg, vec2(64.0, 128.0))\n      - 127.0;\n\n    offset_sig = -2.0 * texCoordsX[6].r + 1.0;\n    calculated_offsetX = offset_sig * offset_v * pow(2.0, offset_e);\n\n\n    texCoordsZ[0] = extractFromSample(texture2D(uSampler, vec2(0.572, 1.0)));\n    texCoordsZ[1] = extractFromSample(texture2D(uSampler, vec2(0.580, 1.0)));\n    texCoordsZ[2] = extractFromSample(texture2D(uSampler, vec2(0.588, 1.0)));\n    texCoordsZ[3] = extractFromSample(texture2D(uSampler, vec2(0.596, 1.0)));\n    texCoordsZ[4] = extractFromSample(texture2D(uSampler, vec2(0.604, 1.0)));\n    texCoordsZ[5] = extractFromSample(texture2D(uSampler, vec2(0.612, 1.0)));\n    texCoordsZ[6] = extractFromSample(texture2D(uSampler, vec2(0.620, 1.0)));\n\n    offset_v = dot(texCoordsZ[0].bgr, vec3(0.0009765625, 0.001953125, 0.00390625))\n      + dot(texCoordsZ[1].bgr, vec3(0.0078125, 0.015625, 0.03125))\n      + dot(texCoordsZ[2].bgr, vec3(0.0625, 0.125, 0.25))\n      + texCoordsZ[3].b * 0.5\n      + 1.0;\n\n    offset_e = dot(texCoordsZ[3].gr, vec2(1.0, 2.0))\n      + dot(texCoordsZ[4].bgr, vec3(4.0, 8.0, 16.0))\n      + dot(texCoordsZ[5].bgr, vec3(32.0, 64.0, 128.0))\n      - 127.0;\n\n    offset_sig = 2.0 * texCoordsZ[6].b - 1.0;\n    calculated_offsetZ = offset_sig * offset_v * pow(2.0, offset_e);\n\n    return vec2(calculated_offsetX, calculated_offsetZ);\n  }\n\n  const float eps = 0.03;\n\n  void main(void) {\n    gl_Position = uPMatrix * vec4(aVertexPosition, 1.0);\n    vPos = (uMVMatrix * vec4(aVertexPosition, 1.0)).xyz;\n    highp vec3 v = normalize( vPos );\n    vOffset = parseOffset();\n    highp float d = length( v.xz );\n    highp vec2 t = normalize(v.xz / d + vOffset) * d;\n    v.xz = t.xy;\n    vRecompute = 0.0;\n    highp float abs_vy = abs(v.y);\n    if ( abs_vy < 0.707106781 ) {\n      vTextureCoord = EquirectPart( v );\n      vRecompute += float( vTextureCoord.x < eps * 0.5 ||\n          vTextureCoord.x > 0.8 - eps * 0.5 );\n    } else {\n      vTextureCoord = FacePart( v );\n      vRecompute += float( abs_vy > 1.0 - eps );\n    }\n    vRecompute += float( abs_vy < 0.707106781 + eps &&\n        abs_vy > 0.707106781 - eps );\n  }\n"}),null);
__d("DefaultRenderer.fs",[],(function(a,b,c,d,e,f){e.exports="\n  varying highp vec2 vTextureCoord;\n\n  uniform sampler2D uSampler;\n\n  void main(void) {\n    gl_FragColor = texture2D(\n      uSampler,\n      vec2(vTextureCoord.s, vTextureCoord.t)\n    );\n  }\n"}),null);
__d("DefaultRenderer.vs",[],(function(a,b,c,d,e,f){e.exports="\n  attribute vec3 aVertexPosition;\n  attribute vec2 aTextureCoord;\n\n  uniform mat4 uMVMatrix;\n  uniform mat4 uPMatrix;\n\n  varying highp vec2 vTextureCoord;\n\n  void main(void) {\n    gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n    vTextureCoord = aTextureCoord;\n  }\n"}),null);
__d("HalfEquirect.fs",[],(function(a,b,c,d,e,f){e.exports="\n  // If changed, copy this constant to the vertex shader\n  #define FEATHER_RATIO 0.0278  // 10 / 360 degrees\n\n  uniform highp mat4 uSTMatrix;\n  uniform mediump vec2 uBoundaries;\n  uniform sampler2D uSampler;\n\n  varying highp vec2 vTextureCoord;\n  varying mediump vec4 vLeftBoundaryColor;\n  varying mediump vec4 vRightBoundaryColor;\n\n  mediump float leftBoundary;\n  mediump float rightBoundary;\n  mediump float processedX;\n\n  mediump vec4 getTextureColor() {\n    return texture2D(uSampler, (uSTMatrix * vec4(vTextureCoord, 0, 1)).xy);\n  }\n\n  mediump float getWrappedValue(mediump float value) {\n    return value + (value < leftBoundary ? 1.0 : 0.0);\n  }\n\n  mediump vec4 interpolate() {\n    mediump float interp = (processedX - rightBoundary) / (1.0 + leftBoundary - rightBoundary);\n    return mix(vRightBoundaryColor, vLeftBoundaryColor, interp);\n  }\n\n  mediump vec4 getFeatheredPixel() {\n    bool useLeftBoundary = processedX <= leftBoundary + FEATHER_RATIO;\n    mediump vec4 currColor = getTextureColor();\n    mediump vec4 boundaryColor = useLeftBoundary ? vLeftBoundaryColor : vRightBoundaryColor;\n    mediump float interp =\n      (useLeftBoundary ? (processedX - leftBoundary) : (rightBoundary - processedX))\n      / FEATHER_RATIO;\n    return mix(boundaryColor, currColor, interp);\n  }\n\n  void main(void) {\n    leftBoundary = uBoundaries.x;\n    rightBoundary = getWrappedValue(uBoundaries.y);\n\n    processedX = getWrappedValue(vTextureCoord.x);\n    bool mainImageBetweenFeatheredBounds =\n      (processedX > leftBoundary + FEATHER_RATIO)\n      && (processedX < rightBoundary - FEATHER_RATIO);\n\n    if (mainImageBetweenFeatheredBounds) {\n      gl_FragColor = getTextureColor();\n    } else if (processedX < leftBoundary || processedX > rightBoundary) {\n      gl_FragColor = interpolate();\n    } else {\n      gl_FragColor = getFeatheredPixel();\n    }\n  }\n"}),null);
__d("HalfEquirect.vs",[],(function(a,b,c,d,e,f){e.exports="\n  #define HALF_WINDOW_SIZE 20\n  #define WINDOW_SIZE 2*HALF_WINDOW_SIZE\n  #define TRIANGLE_WIDTH 0.04  // 1 / 30 triangles\n  #define INV_HEIGHT 0.005\n  #define BLUR_LENGTH float(HALF_WINDOW_SIZE)*INV_HEIGHT\n\n  // If changed, copy this definition to the fragment shader\n  #define FEATHER_RATIO 0.0278  // 10 / 360 degrees\n\n  uniform mat4 uMVMatrix;\n  uniform mat4 uPMatrix;\n  uniform mat4 uSTMatrix;\n  uniform mediump vec2 uBoundaries;\n  uniform sampler2D uSampler;\n\n  attribute vec3 aVertexPosition;\n  attribute vec2 aTextureCoord;\n\n  varying highp vec2 vTextureCoord;\n  varying mediump vec4 vLeftBoundaryColor;\n  varying mediump vec4 vRightBoundaryColor;\n\n  mediump float leftBoundary;\n  mediump float rightBoundary;\n\n  mediump float getUnWrappedValue(mediump float value) {\n    return value - (value > 1.0 ? 1.0 : 0.0);\n  }\n\n  mediump vec4 getVerticalBlurredBoundaryPixel(mediump float y, bool isLeft) {\n    mediump vec4 result = vec4(0.0);\n    mediump float boundaryFactor = FEATHER_RATIO * 0.5;\n    mediump float coordJEnd = clamp(y + BLUR_LENGTH, 0.0, 1.0);\n    mediump float coordJ = clamp(y - BLUR_LENGTH, 0.0, 1.0);\n    int numSamples = 0;\n\n    for (int j = 0; j <= WINDOW_SIZE; j++) {\n      if (coordJ > coordJEnd) {\n        break;\n      }\n      mediump float coordI = isLeft ? leftBoundary : rightBoundary;\n\n      // get boundary pixel color\n      result += texture2D(uSampler, (uSTMatrix * vec4(getUnWrappedValue(coordI), coordJ, 0, 1)).xy);\n\n      // get one more horizontal sample to average out any noise\n      coordI += boundaryFactor * (isLeft ? 1.0 : -1.0);\n      result += texture2D(uSampler, (uSTMatrix * vec4(getUnWrappedValue(coordI), coordJ, 0, 1)).xy);\n\n      numSamples += 2;\n      coordJ += INV_HEIGHT;\n    }\n\n    result.rgb /= float(numSamples);\n    result.a = 1.0;\n    return result;\n  }\n\n  mediump float getWrappedValue(mediump float value) {\n    return value + (value < leftBoundary ? 1.0 : 0.0);\n  }\n\n  void maybeSetBoundaryColors() {\n    mediump float processedX = getWrappedValue(vTextureCoord.x);\n    bool mainImageBetweenFeatheredBounds =\n      processedX > (leftBoundary + FEATHER_RATIO + TRIANGLE_WIDTH)\n      && processedX < (rightBoundary - FEATHER_RATIO - TRIANGLE_WIDTH);\n    if (mainImageBetweenFeatheredBounds) {\n      return;\n    }\n    vLeftBoundaryColor = getVerticalBlurredBoundaryPixel(vTextureCoord.y, true);\n    vRightBoundaryColor = getVerticalBlurredBoundaryPixel(vTextureCoord.y, false);\n  }\n\n  void main(void) {\n    leftBoundary = uBoundaries.x;\n    rightBoundary = getWrappedValue(uBoundaries.y);\n    gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n    vTextureCoord = aTextureCoord;\n    maybeSetBoundaryColors();\n  }\n"}),null);
__d("TextureCubeMap.fs",[],(function(a,b,c,d,e,f){e.exports="\n  varying highp vec3 vVertexDirectionVector;\n  uniform samplerCube uSampler;\n\n  void main(void) {\n    gl_FragColor = textureCube(uSampler, vVertexDirectionVector);\n  }\n"}),null);
__d("TextureCubeMap.vs",[],(function(a,b,c,d,e,f){e.exports="\n  attribute vec3 aVertexPosition;\n\n  uniform mat4 uMVMatrix;\n  uniform mat4 uPMatrix;\n\n  varying highp vec3 vVertexDirectionVector;\n\n  void main(void) {\n    gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n    vVertexDirectionVector = aVertexPosition;\n  }\n"}),null);
__d("SphericalShaderUtils",["CDSFallback.fs","CDSFallback.vs","CDSRenderer.fs","CDSRenderer.vs","DefaultRenderer.fs","DefaultRenderer.vs","HalfEquirect.fs","HalfEquirect.vs","TextureCubeMap.fs","TextureCubeMap.vs"],(function(a,b,c,d,e,f){a={getVertexShader:function(a){switch(a){case"cube_map":return b("TextureCubeMap.vs");case"cds":return b("CDSRenderer.vs");case"cds_fallback":return b("CDSFallback.vs");case"half_equirectangular":return b("HalfEquirect.vs");default:return b("DefaultRenderer.vs")}},getFragmentShader:function(a){switch(a){case"cube_map":return b("TextureCubeMap.fs");case"cds":return b("CDSRenderer.fs");case"cds_fallback":return b("CDSFallback.fs");case"half_equirectangular":return b("HalfEquirect.fs");default:return b("DefaultRenderer.fs")}}};e.exports=a}),null);
__d("SphericalRenderer",["DOM","EventEmitter","EventListener","SphericalShaderUtils","gl-matrix"],(function(a,b,c,d,e,f){var g=b("gl-matrix").glMatrix,h=b("gl-matrix").mat4,i=Math.max(window.devicePixelRatio||1,1),j=.25,k=.75,l=function(){"use strict"};c=function(c){"use strict";babelHelpers.inheritsLoose(d,c);function d(a,b,d){var e;e=c.call(this)||this;e.$SphericalRenderer2=d;e.$SphericalRenderer23=d.fieldOfView;e.$SphericalRenderer18=!0;e.$SphericalRenderer17=a;e.$SphericalRenderer1=b;e.$SphericalRenderer11=h.create();e.$SphericalRenderer12=h.create();e.$SphericalRenderer13=h.create();e.$SphericalRenderer14=h.create();e.$SphericalRenderer3=!1;e.$SphericalRenderer20=[];e.$SphericalRenderer22=null;e.$SphericalRenderer21=null;e.$SphericalRenderer19=d.projectionType==="unpadded_cubestrip";e.$SphericalRenderer9=d.projectionType==="rotated_cubemap";e.$SphericalRenderer7=d.projectionType==="cds_barrel";e.$SphericalRenderer8=!1;e.$SphericalRenderer10=d.projectionType==="half_equirectangular";e.$SphericalRenderer25=new l();e.$SphericalRenderer25.ready=!1;e.$SphericalRenderer26=!1;e.$SphericalRenderer4=e.$SphericalRenderer27.bind(babelHelpers.assertThisInitialized(e));e.$SphericalRenderer5=e.$SphericalRenderer28.bind(babelHelpers.assertThisInitialized(e));e.$SphericalRenderer1.addEventListener("webglcontextlost",e.$SphericalRenderer4);e.$SphericalRenderer1.addEventListener("webglcontextrestored",e.$SphericalRenderer5);e.$SphericalRenderer29();return e}var e=d.prototype;e.destroy=function(){this.removeAllListeners(),this.$SphericalRenderer1.removeEventListener("webglcontextlost",this.$SphericalRenderer4),this.$SphericalRenderer1.removeEventListener("webglcontextrestored",this.$SphericalRenderer5)};e.reconfigure=function(a,b,c){c===void 0&&(c=!1),c&&(this.$SphericalRenderer20=[],this.$SphericalRenderer22=null,this.$SphericalRenderer21=null),this.$SphericalRenderer23=b.fieldOfView,this.$SphericalRenderer17=a,this.$SphericalRenderer2=b,this.$SphericalRenderer19=b.projectionType==="unpadded_cubestrip",this.$SphericalRenderer9=b.projectionType==="rotated_cubemap",this.$SphericalRenderer7=b.projectionType==="cds_barrel",this.$SphericalRenderer10=b.projectionType==="half_equirectangular",this.$SphericalRenderer25.framebuffer=null,this.$SphericalRenderer26=!1,this.$SphericalRenderer29()};e.hasRenderingContext=function(){return!this.$SphericalRenderer3};e.$SphericalRenderer27=function(a){a.preventDefault(),this.emit("renderingContextLost"),this.$SphericalRenderer3=!0};e.$SphericalRenderer28=function(a){this.$SphericalRenderer3=!1,this.$SphericalRenderer29(),this.emit("renderingContextRestore")};e.setAutoUpdateTexture=function(a){this.$SphericalRenderer18=a};e.updateFieldOfView=function(a){this.$SphericalRenderer23!==a&&(this.$SphericalRenderer23=a,this.$SphericalRenderer30())};e.updateViewportDimensions=function(a,b){this.$SphericalRenderer1.width=a*i,this.$SphericalRenderer1.height=b*i,this.$SphericalRenderer30()};e.$SphericalRenderer30=function(){h.perspective(this.$SphericalRenderer11,g.toRadian(this.$SphericalRenderer23),this.$SphericalRenderer1.width/this.$SphericalRenderer1.height,.1,100),this.$SphericalRenderer6.viewport(0,0,this.$SphericalRenderer6.drawingBufferWidth,this.$SphericalRenderer6.drawingBufferHeight)};e.$SphericalRenderer31=function(){this.$SphericalRenderer14=h.create(),this.$SphericalRenderer10&&(this.$SphericalRenderer14[0]=1/this.$SphericalRenderer24.x/(k-j),this.$SphericalRenderer14[5]=1/this.$SphericalRenderer24.y,this.$SphericalRenderer14[12]=-(this.$SphericalRenderer14[0]*j),this.$SphericalRenderer24={x:1,y:1})};e.$SphericalRenderer29=function(){this.$SphericalRenderer32();if(this.$SphericalRenderer7){var a=this.$SphericalRenderer6.getParameter(this.$SphericalRenderer6.MAX_VERTEX_TEXTURE_IMAGE_UNITS);this.$SphericalRenderer8=a==0}this.updateViewportDimensions(this.$SphericalRenderer1.clientWidth,this.$SphericalRenderer1.clientHeight);this.$SphericalRenderer24={x:this.$SphericalRenderer2.stereoFormat==="left-right"?2:1,y:this.$SphericalRenderer2.stereoFormat==="top-bottom"?2:1};this.$SphericalRenderer31();this.$SphericalRenderer33();this.$SphericalRenderer34();this.$SphericalRenderer6.clearColor(0,0,0,1);this.$SphericalRenderer17.setAttribute("crossorigin","anonymous")};e.getScreenshotDataURL=function(a,b,c,d){if(!this.$SphericalRenderer6||this.$SphericalRenderer3)return"";this.render(a,b);return this.$SphericalRenderer1.toDataURL(c,d)};e.$SphericalRenderer32=function(){if(this.$SphericalRenderer6&&!this.$SphericalRenderer3)return;if(!(a.WebGLRenderingContext||a.WebGL2RenderingContext))throw new Error("WebGLRenderingContext not available.");var c=["webgl2","webgl","experimental-webgl"],d=null,e=null,f=b("EventListener").listen(this.$SphericalRenderer1,"webglcontextcreationerror",function(a){return e=a.statusMessage});for(var g=0;g<c.length;g++){try{d=this.$SphericalRenderer1.getContext(c[g])}catch(a){}if(d)break}f.remove();if(!d){e||(e="Unknown error.");throw new Error("Failed to acquire 3D rendering context: "+e)}this.$SphericalRenderer6=d;this.$SphericalRenderer3=!1};e.$SphericalRenderer33=function(){var a=this.$SphericalRenderer7?this.$SphericalRenderer8?"cds_fallback":"cds":this.$SphericalRenderer19?"cube_map":this.$SphericalRenderer10?"half_equirectangular":"default",b=this.$SphericalRenderer35(a);a=this.$SphericalRenderer36(a);this.$SphericalRenderer16=this.$SphericalRenderer6.createProgram();this.$SphericalRenderer6.attachShader(this.$SphericalRenderer16,b);this.$SphericalRenderer6.attachShader(this.$SphericalRenderer16,a);this.$SphericalRenderer6.linkProgram(this.$SphericalRenderer16)};e.$SphericalRenderer37=function(){if(!this.$SphericalRenderer6.getProgramParameter(this.$SphericalRenderer16,this.$SphericalRenderer6.LINK_STATUS)){var a="",b=this.$SphericalRenderer6.getAttachedShaders(this.$SphericalRenderer16);for(var c=0;c<b.length;c++)if(!this.$SphericalRenderer6.getShaderParameter(b[c],this.$SphericalRenderer6.COMPILE_STATUS)){a="Shader error: "+this.$SphericalRenderer6.getShaderInfoLog(b[c]);break}a===""&&(a="Program link error: "+this.$SphericalRenderer6.getProgramInfoLog(this.$SphericalRenderer16));throw new Error(a)}this.$SphericalRenderer6.useProgram(this.$SphericalRenderer16);this.$SphericalRenderer16.vertexPositionAttribute=this.$SphericalRenderer6.getAttribLocation(this.$SphericalRenderer16,"aVertexPosition");this.$SphericalRenderer6.enableVertexAttribArray(this.$SphericalRenderer16.vertexPositionAttribute);this.$SphericalRenderer16.pMatrixUniform=this.$SphericalRenderer6.getUniformLocation(this.$SphericalRenderer16,"uPMatrix");this.$SphericalRenderer16.mvMatrixUniform=this.$SphericalRenderer6.getUniformLocation(this.$SphericalRenderer16,"uMVMatrix");this.$SphericalRenderer16.stMatrixUniform=this.$SphericalRenderer6.getUniformLocation(this.$SphericalRenderer16,"uSTMatrix");this.$SphericalRenderer16.samplerUniform=this.$SphericalRenderer6.getUniformLocation(this.$SphericalRenderer16,"uSampler");!this.$SphericalRenderer19&&!this.$SphericalRenderer7&&(this.$SphericalRenderer16.textureCoordAttribute=this.$SphericalRenderer6.getAttribLocation(this.$SphericalRenderer16,"aTextureCoord"),this.$SphericalRenderer6.enableVertexAttribArray(this.$SphericalRenderer16.textureCoordAttribute));this.$SphericalRenderer8&&(this.$SphericalRenderer16.offsetUniform=this.$SphericalRenderer6.getUniformLocation(this.$SphericalRenderer16,"uOffset"));this.$SphericalRenderer10&&(this.$SphericalRenderer16.boundariesUniform=this.$SphericalRenderer6.getUniformLocation(this.$SphericalRenderer16,"uBoundaries"));this.$SphericalRenderer26=!0};e.$SphericalRenderer34=function(){this.$SphericalRenderer15=this.$SphericalRenderer6.createTexture();this.$SphericalRenderer15.image=this.$SphericalRenderer17;var a=this.$SphericalRenderer19?this.$SphericalRenderer6.TEXTURE_CUBE_MAP:this.$SphericalRenderer6.TEXTURE_2D;this.$SphericalRenderer6.bindTexture(a,this.$SphericalRenderer15);this.$SphericalRenderer6.texParameteri(a,this.$SphericalRenderer6.TEXTURE_MAG_FILTER,this.$SphericalRenderer6.LINEAR);this.$SphericalRenderer6.texParameteri(a,this.$SphericalRenderer6.TEXTURE_MIN_FILTER,this.$SphericalRenderer6.LINEAR);this.$SphericalRenderer6.texParameteri(a,this.$SphericalRenderer6.TEXTURE_WRAP_S,this.$SphericalRenderer6.CLAMP_TO_EDGE);this.$SphericalRenderer6.texParameteri(a,this.$SphericalRenderer6.TEXTURE_WRAP_T,this.$SphericalRenderer6.CLAMP_TO_EDGE)};e.$SphericalRenderer38=function(a,b,c,d,e,f){b===void 0&&(b=30);c===void 0&&(c=30);d===void 0&&(d=Math.PI);e===void 0&&(e=Math.PI*2);f===void 0&&(f=0);var g=2,h=[],i=[],j,k;for(j=0;j<=b;j++){var l=(j/b-.5)*d,m=Math.sin(l);l=Math.cos(l);for(k=0;k<=c;k++){var n=(k/c-.5)*e+f,o=Math.sin(n);n=Math.cos(n);n=n*l;var p=m;o=o*l;var q=k/c/this.$SphericalRenderer24.x,r=j/b/this.$SphericalRenderer24.y;i.push(q);i.push(r);h.push(g*n);h.push(g*p);h.push(g*o)}}q=[];for(j=0;j<b;j++)for(k=0;k<c;k++){r=j*(c+1)+k;n=r+c+1;q.push(r);q.push(n);q.push(r+1);q.push(n);q.push(n+1);q.push(r+1)}this.$SphericalRenderer20[a]=this.$SphericalRenderer6.createBuffer();this.$SphericalRenderer6.bindBuffer(this.$SphericalRenderer6.ARRAY_BUFFER,this.$SphericalRenderer20[a]);this.$SphericalRenderer6.bufferData(this.$SphericalRenderer6.ARRAY_BUFFER,new Float32Array(i),this.$SphericalRenderer6.STATIC_DRAW);this.$SphericalRenderer20[a].itemSize=2;this.$SphericalRenderer20[a].numItems=i.length/2;this.$SphericalRenderer22=this.$SphericalRenderer6.createBuffer();this.$SphericalRenderer6.bindBuffer(this.$SphericalRenderer6.ARRAY_BUFFER,this.$SphericalRenderer22);this.$SphericalRenderer6.bufferData(this.$SphericalRenderer6.ARRAY_BUFFER,new Float32Array(h),this.$SphericalRenderer6.STATIC_DRAW);this.$SphericalRenderer22&&(this.$SphericalRenderer22.itemSize=3,this.$SphericalRenderer22.numItems=h.length/3);this.$SphericalRenderer21=this.$SphericalRenderer6.createBuffer();this.$SphericalRenderer6.bindBuffer(this.$SphericalRenderer6.ELEMENT_ARRAY_BUFFER,this.$SphericalRenderer21);this.$SphericalRenderer6.bufferData(this.$SphericalRenderer6.ELEMENT_ARRAY_BUFFER,new Uint16Array(q),this.$SphericalRenderer6.STATIC_DRAW);this.$SphericalRenderer21&&(this.$SphericalRenderer21.itemSize=1,this.$SphericalRenderer21.numItems=q.length)};e.$SphericalRenderer39=function(a,b){var c=40,d=60,e=2,f=[],g=[],h=[],i=[],j,k;for(j=0;j<=c;j++){var l=j/c-.5,m=l*.5*Math.PI,n=Math.sin(m);m=Math.cos(m);var o=(l/a+.5)/this.$SphericalRenderer24.y;for(k=0;k<=d;k++){var p=k/d-.5,q=p*2*Math.PI,r=Math.sin(q);q=Math.cos(q);var s=q*m*e,t=n*e,u=r*m*e;p=(p/a*.8+.4)/this.$SphericalRenderer24.x;g.push(p);g.push(o);f.push(s);f.push(t);f.push(u);if(j==0||j==c){p=Math.sign(1-j);r=(r*.1/a+.9)/this.$SphericalRenderer24.x;q=(q*.25*p/a+.5+l*.5)/this.$SphericalRenderer24.y;i.push(r);i.push(q);h.push(s);h.push(t);h.push(u)}}}p=f.length/3;g.push.apply(g,i);f.push.apply(f,h);r=f.length/3;q=Math.sin(Math.PI*.25)*e;g.push(.9/this.$SphericalRenderer24.x);g.push(.25/this.$SphericalRenderer24.y);f.push(0);f.push(-q);f.push(0);g.push(.9/this.$SphericalRenderer24.x);g.push(.75/this.$SphericalRenderer24.y);f.push(0);f.push(q);f.push(0);s=[];for(j=0;j<c;j++)for(k=0;k<d;k++){t=j*(d+1)+k;u=t+d+1;s.push(t);s.push(u);s.push(t+1);s.push(u);s.push(u+1);s.push(t+1)}for(var m=0;m<2;m++)for(k=0;k<d;k++)s.push(k+p+m*(d+1)),s.push(k+p+m*(d+1)+1),s.push(r+m);this.$SphericalRenderer20[b]=this.$SphericalRenderer6.createBuffer();this.$SphericalRenderer6.bindBuffer(this.$SphericalRenderer6.ARRAY_BUFFER,this.$SphericalRenderer20[b]);this.$SphericalRenderer6.bufferData(this.$SphericalRenderer6.ARRAY_BUFFER,new Float32Array(g),this.$SphericalRenderer6.STATIC_DRAW);this.$SphericalRenderer20[b].itemSize=2;this.$SphericalRenderer20[b].numItems=g.length/2;this.$SphericalRenderer22=this.$SphericalRenderer6.createBuffer();this.$SphericalRenderer6.bindBuffer(this.$SphericalRenderer6.ARRAY_BUFFER,this.$SphericalRenderer22);this.$SphericalRenderer6.bufferData(this.$SphericalRenderer6.ARRAY_BUFFER,new Float32Array(f),this.$SphericalRenderer6.STATIC_DRAW);this.$SphericalRenderer22&&(this.$SphericalRenderer22.itemSize=3,this.$SphericalRenderer22.numItems=f.length/3);this.$SphericalRenderer21=this.$SphericalRenderer6.createBuffer();this.$SphericalRenderer6.bindBuffer(this.$SphericalRenderer6.ELEMENT_ARRAY_BUFFER,this.$SphericalRenderer21);this.$SphericalRenderer6.bufferData(this.$SphericalRenderer6.ELEMENT_ARRAY_BUFFER,new Uint16Array(s),this.$SphericalRenderer6.STATIC_DRAW);this.$SphericalRenderer21&&(this.$SphericalRenderer21.itemSize=1,this.$SphericalRenderer21.numItems=s.length)};e.$SphericalRenderer40=function(a,b,c){this.$SphericalRenderer9?a=[1,3,7,5,6,7,3,2,0,2,3,1,4,5,7,6,4,6,2,0,0,1,5,4]:a=[5,1,3,7,0,4,6,2,6,7,3,2,0,1,5,4,4,5,7,6,1,0,2,3];var d=[];for(var e=0;e<a.length;e++){var f=a[e]>>2&1,g=a[e]>>1&1,h=a[e]>>0&1;d.push(f*2-1);d.push(g*2-1);d.push(h*2-1)}this.$SphericalRenderer22=this.$SphericalRenderer6.createBuffer();this.$SphericalRenderer6.bindBuffer(this.$SphericalRenderer6.ARRAY_BUFFER,this.$SphericalRenderer22);this.$SphericalRenderer6.bufferData(this.$SphericalRenderer6.ARRAY_BUFFER,new Float32Array(d),this.$SphericalRenderer6.STATIC_DRAW);this.$SphericalRenderer22&&(this.$SphericalRenderer22.itemSize=3,this.$SphericalRenderer22.numItems=d.length/3);if(!this.$SphericalRenderer19){var i;f=[];if(this.$SphericalRenderer9){g=this.$SphericalRenderer15.image.videoWidth/2;b=g/(Math.floor(g/32)*32);h=(1-1/b)/2;e=3;d=2;g=1/d;i=1/e}else h=(1-1/b)/2,e=2,d=3,g=1/d,i=1/e;for(var b=0;b<e;++b)for(var j=0;j<d;++j){var k=e-1-b,l=j;f.push((l+h)*g);f.push((k+h)*i);f.push((l+1-h)*g);f.push((k+h)*i);f.push((l+1-h)*g);f.push((k+1-h)*i);f.push((l+h)*g);f.push((k+1-h)*i)}this.$SphericalRenderer20[c]=this.$SphericalRenderer6.createBuffer();this.$SphericalRenderer6.bindBuffer(this.$SphericalRenderer6.ARRAY_BUFFER,this.$SphericalRenderer20[c]);this.$SphericalRenderer6.bufferData(this.$SphericalRenderer6.ARRAY_BUFFER,new Float32Array(f),this.$SphericalRenderer6.STATIC_DRAW);this.$SphericalRenderer20[c].itemSize=2;this.$SphericalRenderer20[c].numItems=f.length/2}l=[];for(var k=0;k<a.length;k+=4)l.push(k),l.push(k+2),l.push(k+1),l.push(k),l.push(k+3),l.push(k+2);this.$SphericalRenderer21=this.$SphericalRenderer6.createBuffer();this.$SphericalRenderer6.bindBuffer(this.$SphericalRenderer6.ELEMENT_ARRAY_BUFFER,this.$SphericalRenderer21);this.$SphericalRenderer6.bufferData(this.$SphericalRenderer6.ELEMENT_ARRAY_BUFFER,new Uint16Array(l),this.$SphericalRenderer6.STATIC_DRAW);this.$SphericalRenderer21&&(this.$SphericalRenderer21.itemSize=1,this.$SphericalRenderer21.numItems=l.length)};e.$SphericalRenderer35=function(a){var c=this.$SphericalRenderer6.createShader(this.$SphericalRenderer6.VERTEX_SHADER);a=b("SphericalShaderUtils").getVertexShader(a);this.$SphericalRenderer6.shaderSource(c,a);this.$SphericalRenderer6.compileShader(c);return c};e.$SphericalRenderer36=function(a){var c=this.$SphericalRenderer6.createShader(this.$SphericalRenderer6.FRAGMENT_SHADER);a=b("SphericalShaderUtils").getFragmentShader(a);this.$SphericalRenderer6.shaderSource(c,a);this.$SphericalRenderer6.compileShader(c);return c};e.$SphericalRenderer41=function(){this.$SphericalRenderer25.framebuffer=this.$SphericalRenderer6.createFramebuffer(),this.$SphericalRenderer6.bindFramebuffer(this.$SphericalRenderer6.FRAMEBUFFER,this.$SphericalRenderer25.framebuffer),this.$SphericalRenderer6.framebufferTexture2D(this.$SphericalRenderer6.FRAMEBUFFER,this.$SphericalRenderer6.COLOR_ATTACHMENT0,this.$SphericalRenderer6.TEXTURE_2D,this.$SphericalRenderer15,0),this.$SphericalRenderer6.bindFramebuffer(this.$SphericalRenderer6.FRAMEBUFFER,null)};e.$SphericalRenderer42=function(){this.$SphericalRenderer6.bindFramebuffer(this.$SphericalRenderer6.FRAMEBUFFER,this.$SphericalRenderer25.framebuffer),this.$SphericalRenderer6.readPixels(0,this.$SphericalRenderer15.image.videoHeight-1,this.$SphericalRenderer15.image.videoWidth,1,this.$SphericalRenderer6.RGBA,this.$SphericalRenderer6.UNSIGNED_BYTE,this.$SphericalRenderer25.pixels),this.$SphericalRenderer6.bindFramebuffer(this.$SphericalRenderer6.FRAMEBUFFER,null)};e.$SphericalRenderer43=function(){this.$SphericalRenderer25.bitmask.fill(0);var a=[0,0,0],b=this.$SphericalRenderer15.image.videoWidth/125,c=Math.round(b),d;for(d=0;d<33;++d){var e=Math.floor((45+d)*b)*4,f=128,g=127;for(var h=0;h<3;++h){a[h]=0;for(var i=0;i<c;++i)a[h]+=this.$SphericalRenderer25.pixels[e+i*4+(2-h)];a[h]/=c;f=Math.max(f,a[h]);g=Math.min(g,a[h])}for(h=0;h<3;++h){i=(a[h]-g)/(f-g);this.$SphericalRenderer25.bitmask[d*3+h]=i>.5?1:0}}for(d=0;d<12;++d){e=0;for(var i=0;i<8;++i)e+=this.$SphericalRenderer25.bitmask[1+d*8+i]*Math.pow(2,i);this.$SphericalRenderer25.dataView.setUint8(d,e)}this.$SphericalRenderer25.offsetX=this.$SphericalRenderer25.dataView.getFloat32(0,!0);this.$SphericalRenderer25.offsetZ=-this.$SphericalRenderer25.dataView.getFloat32(8,!0)};e.$SphericalRenderer44=function(){try{this.$SphericalRenderer25.ready||(this.$SphericalRenderer25.pixels=new Uint8Array(3840*4),this.$SphericalRenderer25.bitmask=new Uint8Array(33*3),this.$SphericalRenderer25.dataView=new DataView(new ArrayBuffer(12)),this.$SphericalRenderer25.ready=!0),this.$SphericalRenderer25.framebuffer||this.$SphericalRenderer41(),this.$SphericalRenderer42(),this.$SphericalRenderer43()}catch(a){this.emit("renderingError",a)}};e.$SphericalRenderer45=function(){if(this.$SphericalRenderer19)this.$SphericalRenderer46();else{this.$SphericalRenderer6.bindTexture(this.$SphericalRenderer6.TEXTURE_2D,this.$SphericalRenderer15);this.$SphericalRenderer6.pixelStorei(this.$SphericalRenderer6.UNPACK_FLIP_Y_WEBGL,!this.$SphericalRenderer7);try{this.$SphericalRenderer6.texImage2D(this.$SphericalRenderer6.TEXTURE_2D,0,this.$SphericalRenderer6.RGBA,this.$SphericalRenderer6.RGBA,this.$SphericalRenderer6.UNSIGNED_BYTE,this.$SphericalRenderer15.image)}catch(a){this.emit("renderingError",a)}this.$SphericalRenderer8&&this.$SphericalRenderer44()}};e.renderWithRotationMatrix=function(a){if(this.$SphericalRenderer3)return;this.$SphericalRenderer18&&this.$SphericalRenderer45();this.$SphericalRenderer12=a;this.$SphericalRenderer7&&h.rotateY(this.$SphericalRenderer12,this.$SphericalRenderer12,g.toRadian(-90));this.$SphericalRenderer47()};e.render=function(a,b){if(this.$SphericalRenderer3)return;this.$SphericalRenderer18&&this.$SphericalRenderer45();this.$SphericalRenderer9?(h.identity(this.$SphericalRenderer12),h.rotateX(this.$SphericalRenderer12,this.$SphericalRenderer12,g.toRadian(-b)),h.rotateY(this.$SphericalRenderer12,this.$SphericalRenderer12,g.toRadian(a-135)),h.rotateZ(this.$SphericalRenderer12,this.$SphericalRenderer12,g.toRadian(45))):(this.$SphericalRenderer7&&(a-=90),h.identity(this.$SphericalRenderer12),h.rotateX(this.$SphericalRenderer12,this.$SphericalRenderer12,-g.toRadian(b)),h.rotateY(this.$SphericalRenderer12,this.$SphericalRenderer12,g.toRadian(a)));this.$SphericalRenderer47()};e.$SphericalRenderer47=function(){if(this.$SphericalRenderer19)this.$SphericalRenderer22===null&&this.$SphericalRenderer40(this.$SphericalRenderer2.projectionType,this.$SphericalRenderer2.expansionCoef||0,0);else{this.$SphericalRenderer26||(this.$SphericalRenderer37(),this.$SphericalRenderer6.activeTexture(this.$SphericalRenderer6.TEXTURE0));var a=this.$SphericalRenderer15.image.videoWidth;this.$SphericalRenderer2.projectionType==="cubemap"||this.$SphericalRenderer2.projectionType==="rotated_cubemap"?a in this.$SphericalRenderer20||this.$SphericalRenderer40(this.$SphericalRenderer2.projectionType,this.$SphericalRenderer2.expansionCoef||0,a):this.$SphericalRenderer2.projectionType==="barrel"?a in this.$SphericalRenderer20||this.$SphericalRenderer39(this.$SphericalRenderer2.expansionCoef||1.01,a):this.$SphericalRenderer7?a in this.$SphericalRenderer20||this.$SphericalRenderer38(a,40,40,Math.PI/180*111,Math.PI/180*142,-Math.PI/2):a in this.$SphericalRenderer20||this.$SphericalRenderer38(a);this.$SphericalRenderer7||(this.$SphericalRenderer6.bindBuffer(this.$SphericalRenderer6.ARRAY_BUFFER,this.$SphericalRenderer20[a]),this.$SphericalRenderer6.vertexAttribPointer(this.$SphericalRenderer16.textureCoordAttribute,this.$SphericalRenderer20[a].itemSize,this.$SphericalRenderer6.FLOAT,!1,0,0))}this.$SphericalRenderer6.uniform1i(this.$SphericalRenderer16.samplerUniform,0);this.$SphericalRenderer6.bindBuffer(this.$SphericalRenderer6.ARRAY_BUFFER,this.$SphericalRenderer22);this.$SphericalRenderer22&&this.$SphericalRenderer6.vertexAttribPointer(this.$SphericalRenderer16.vertexPositionAttribute,this.$SphericalRenderer22.itemSize,this.$SphericalRenderer6.FLOAT,!1,0,0);this.$SphericalRenderer6.bindBuffer(this.$SphericalRenderer6.ELEMENT_ARRAY_BUFFER,this.$SphericalRenderer21);this.$SphericalRenderer6.uniformMatrix4fv(this.$SphericalRenderer16.pMatrixUniform,!1,this.$SphericalRenderer11);this.$SphericalRenderer10&&this.$SphericalRenderer6.uniform2f(this.$SphericalRenderer16.boundariesUniform,j,k);this.$SphericalRenderer7?(h.invert(this.$SphericalRenderer13,this.$SphericalRenderer12),this.$SphericalRenderer6.uniformMatrix4fv(this.$SphericalRenderer16.mvMatrixUniform,!1,this.$SphericalRenderer13),this.$SphericalRenderer8&&this.$SphericalRenderer6.uniform2f(this.$SphericalRenderer16.offsetUniform,this.$SphericalRenderer25.offsetX,this.$SphericalRenderer25.offsetZ)):this.$SphericalRenderer6.uniformMatrix4fv(this.$SphericalRenderer16.mvMatrixUniform,!1,this.$SphericalRenderer12);this.$SphericalRenderer10&&this.$SphericalRenderer6.uniformMatrix4fv(this.$SphericalRenderer16.stMatrixUniform,!1,this.$SphericalRenderer14);this.$SphericalRenderer21&&this.$SphericalRenderer6.drawElements(this.$SphericalRenderer6.TRIANGLES,this.$SphericalRenderer21.numItems,this.$SphericalRenderer6.UNSIGNED_SHORT,0)};e.$SphericalRenderer48=function(){var a=this.$SphericalRenderer6.getParameter(this.$SphericalRenderer6.MAX_CUBE_MAP_TEXTURE_SIZE),b=this.$SphericalRenderer15.image.width;return Math.min(a,b)};e.$SphericalRenderer46=function(){var a=this.$SphericalRenderer48(),c=this.$SphericalRenderer15.image.width,d=b("DOM").create("canvas",{width:a,height:a});d=d.getContext("2d");this.$SphericalRenderer6.bindTexture(this.$SphericalRenderer6.TEXTURE_CUBE_MAP,this.$SphericalRenderer15);this.$SphericalRenderer6.pixelStorei(this.$SphericalRenderer6.UNPACK_FLIP_Y_WEBGL,!1);for(var e=0;e<6;e++){d.drawImage(this.$SphericalRenderer15.image,0,e*c,c,c,0,0,a,a);var f=new Uint8Array(d.getImageData(0,0,a,a).data);this.$SphericalRenderer6.texImage2D(this.$SphericalRenderer6.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,this.$SphericalRenderer6.RGBA,a,a,0,this.$SphericalRenderer6.RGBA,this.$SphericalRenderer6.UNSIGNED_BYTE,f)}};return d}(b("EventEmitter"));e.exports=c}),null);
__d("SphericalVideoPlayer",["cx","invariant","Arbiter","Banzai","CSS","DOM","DOMDimensions","Event","FullScreen","SphericalMediaCanvasPool","SphericalParallaxUtils","SphericalRenderer","SphericalVideoComponentActions","SphericalVideoComponentDispatcher","SphericalVideoHalfEquirectConfig","SphericalVideoPlayerEvents","SphericalViewportControl","SubscriptionsHandler","VideoPlayerReasonTransitionHelper","forwardEvent","getElementRect","getFullScreenElement","getViewportDimensions","gkx","onViewportChanged","requestAnimationFrame","uniqueID","SphericalViewportControlStore","VideoPlayerControllerStore"],(function(a,b,c,d,e,f,g,h){"use strict";var i=b("SphericalParallaxUtils").calculateYawOffset,j="SphericalVideoPlayer";c=2;var k=1e3;d=.8;f=16;g=15;var l=d/f/g,m=50,n=.1;b("SphericalMediaCanvasPool").setLimit(c,j);d=function(){function c(a,c){var d=this;this.$48=function(){var a=!!d.$1.getOption("VideoWithSphericalGuide","auto");if(d.$1.getSource()!=="inline"||a)return;a=d.$55();if(a===null)return;typeof a==="number"||h(0,1207);d.$26=a;d.$29&&(d.$24=d.$12.getOrientation().x-d.$26,d.$25=d.$26,d.$29=!1)};this.$50=function(){d.$1.isState("paused")||d.$1.pause("spherical_switch_canvas"),d.$57(),d.$46()};this.$54=function(a){if(!d.$14)return;var c=d.$14,e=d.$30?a-d.$30:0;e=d.$56(e);e&&d.$36(d.$24+d.$25,null);if(d.$2.readyState>=d.$2.HAVE_CURRENT_DATA&&(d.$44()||d.$7||e)){d.$7=!1;e=d.$12.getOrientation();c.render(e.x+90,e.y);d.$16&&(d.$16.remove(),d.$16=null)}d.$30=a;b("requestAnimationFrame")(d.$54)};this.$33=function(a,b){d.$12.setRelativeSphericalOrientation(a,b)};this.$36=function(a,b){d.$12.setSphericalOrientation(a,b)};this.$37=function(a){d.$14&&(d.$14.updateFieldOfView(a),d.$12.setFieldOfView(a),d.$20=a,d.$32())};this.$38=function(a){d.$14&&(d.$10.projectionType=a,d.$14.reconfigure(d.$2,d.$10,!0),d.$32())};this.$39=function(a){d.$14&&(d.$10.stereoFormat=a,d.$14.reconfigure(d.$2,d.$10,!0),d.$32())};this.$40=function(a){d.$12&&(d.$10.partialLimits=a,d.$12.reconfigure(d.$10),d.$32())};this.$41=function(a){a===void 0&&(a={}),d.$12&&(d.$12.reconfigureControlConfig(a),d.$32())};this.$34=function(a,c){if(b("FullScreen").isFullScreen()&&(a<d.$5.width||c<d.$5.height))return;d.$14?(d.$5.width=a,d.$5.height=c,d.$53(d.$14,a,c),d.$11.useViewportDimension&&(d.$6=b("DOMDimensions").getElementDimensions(d.$4)),d.$32()):d.$5={width:a,height:c}};this.$52=function(a,b,c){if(!d.$14)return;a=a>=0?(a+180)%360-180:(a-180)%360+180;d.$59(a,b);d.$19.yaw=a;d.$19.pitch=b;d.$20=c;d.$14&&d.$14.updateFieldOfView(c);d.$58(a);d.$32()};this.$10=a;this.$11=Object.assign({viewportClassName:"_2a6s",canvasClassName:"_38vt",placeholderImgClassName:"_44h9",videoID:"",playerID:void 0,eagerPreload:void 0,preventScrollDefaultAction:void 0,useViewportDimension:void 0,useContainerDimensions:void 0},c);this.$22=0;this.$28=!0;this.$29=!1}var d=c.prototype;d.enable=function(c){var d=this;if(this.$1)return;this.$1=c;if(typeof a.WebGLRenderingContext!=="function"&&typeof a.WebGL2RenderingContext!=="function"){this.$31({error:"SPHERICAL_SETUP_FAILED",message:"WebGLRenderingContext not available."});return}if(!b("gkx")("678912")){this.$31({error:"SPHERICAL_RENDER_ERROR",message:"Unsupported browser version"});return}var e=c.getVideoNode();e instanceof HTMLVideoElement||h(0,1208);this.$2=e;this.$7=!1;this.$18=!0;this.$8=new(b("SubscriptionsHandler"))();this.$8.addSubscriptions(b("Event").listen(this.$2,"loadeddata",function(){return d.$32()}),b("Event").listen(this.$2,"seeked",function(){return d.$32()}),b("Event").listen(this.$2,"ended",function(){return d.$33(0,0)}),b("Event").listen(window,"resize",function(){b("FullScreen").isFullScreen()&&d.$1.getContainerNode()===b("getFullScreenElement")()&&d.$34(window.innerWidth,window.innerHeight)}),c.addListener("stateChange",function(){(c.isState("destroyed")||c.isState("fallback")&&(c.isLiveVideo()||!c.isFallbackRecoverable()))&&d.$35()}),c.addListener("VideoPlayerFallbackEvents/recover",function(){d.$35(),b("CSS").removeClass(d.$2,"_3axk"),d.$1.play(new(b("VideoPlayerReasonTransitionHelper"))("spherical_fallback"))}),c.addListener(b("SphericalVideoPlayerEvents").SET_ABSOLUTE_SPHERICAL_ORIENTATION,this.$36),c.addListener(b("SphericalVideoPlayerEvents").SET_RELATIVE_SPHERICAL_ORIENTATION,this.$33),c.addListener(b("SphericalVideoPlayerEvents").SET_FIELD_OF_VIEW,this.$37),c.addListener(b("SphericalVideoPlayerEvents").SET_VIDEO_PROJECTION,this.$38),c.addListener(b("SphericalVideoPlayerEvents").SET_STEREO_MODE,this.$39),c.addListener(b("SphericalVideoPlayerEvents").SET_PARTIAL_LIMITS,this.$40),c.addListener(b("SphericalVideoPlayerEvents").SET_VIEWPORT_CONTROL_CONFIG,this.$41),c.addListener("dimensionsChange",this.$34),c.once("changeVolume",function(){return d.$18=!1}),c.once("muteVideo",function(){return d.$18=!1}),c.once("unmuteVideo",function(){return d.$18=!1}),c.addListener("toggleFullscreen",function(){return d.$4.focus()}),c.addListener("TahoeController/enterTahoe",function(){d.$4.focus(),d.$12.setEnableZoom(!0),d.$23=!0,d.$1.emit("SphericalVideoPlayer/zoomEnabled")}),c.addListener("TahoeController/exitTahoe",function(){d.$4.focus(),d.$12.setEnableZoom(!1),d.$23=!1,d.$1.emit("SphericalVideoPlayer/zoomDisabled")}));if(this.$11.useContainerDimensions){var f=c.getContainerNode();this.$5=b("DOMDimensions").getElementDimensions(f)}else this.$5=b("DOMDimensions").getElementDimensions(e),(this.$5.width===0||this.$5.height===0)&&(this.$5={width:e.width,height:e.height});this.$15=this.$1.getVideoPlayerID()||b("uniqueID")();this.$19={yaw:this.$10.initialHeading,pitch:this.$10.initialPitch};this.$20=this.$10.fieldOfView;this.$23=!1;f=c.getVideoProjection();f&&(this.$10.projectionType=f);b("CSS").addClass(e,"_3axk");this.$42();c.registerOption("SphericalVideoPlayer","getDimensions",function(){return d.$11.useViewportDimension?d.$6:d.$5});c.registerOption("SphericalVideoPlayer","isReady",function(){return!!d.$14});c.registerOption("SphericalVideoPlayer","getScreenshotDataURL",function(){return d.$43()});c.registerOption("SphericalVideoPlayer","getIsSingleFisheye",function(){return d.$10.isSingleFisheye&&d.$10.originalFOV!==null});c.registerOption("SphericalVideoPlayer","getOriginalFOV",function(){return d.$10.originalFOV});c.registerOption("SphericalVideoPlayer","getEnableZoom",function(){return d.$23});c.registerOption("SphericalVideoPlayer","getIsHalfEquirectangular",function(){return d.$10.projectionType==="half_equirectangular"});this.$44()||this.$11.eagerPreload?this.$45():this.$46()};d.disable=function(){this.$35()};d.$45=function(){if(this.$1.getOption("SphericalVideoPlayer","isUnavailable"))return;this.$17&&(this.$17.remove(),this.$17=null);try{this.$47()}catch(a){this.$31({error:"SPHERICAL_SETUP_FAILED",message:a.message});return}this.$1.setStillFrameEnabled(!1);this.$32();this.$1.emit("SphericalVideoPlayer/ready");var a=this.$12.getOrientation().x;this.$28?this.$24=a:this.$29=!0;this.$27=b("onViewportChanged")(this.$48);this.$28=!1};d.$46=function(){var a=this;this.$17=this.$1.addListener("stateChange",function(){a.$44()&&a.$45()})};d.$49=function(){if(!this.$14)return;var a=this.$43();a=b("DOM").create("img",{width:this.$5.width,height:this.$5.height,src:a,className:this.$11.placeholderImgClassName});b("DOM").insertAfter(this.$2,a);this.$16&&this.$16.remove();this.$16=a;this.$50()};d.$43=function(a,b){if(!this.$14)return"";var c=this.$14,d=this.$12.getOrientation(),e=d.x;d=d.y;return c.getScreenshotDataURL(e+90,d,a,b)};d.$42=function(){var a=this,c=b("DOM").create("div",{className:this.$11.viewportClassName,tabIndex:0}),d={};if(this.$10.isSingleFisheye&&this.$10.originalFOV){var e=this.$10.originalFOV/2;this.$10.partialLimits={partialLeftDegrees:e,partialRightDegrees:e,partialTopDegrees:e,partialBottomDegrees:e};d=this.$51()}this.$10.projectionType==="half_equirectangular"&&(this.$10.partialLimits=b("SphericalVideoHalfEquirectConfig").getHalfEquirectangularPartialLimits(),d=b("SphericalVideoHalfEquirectConfig").getHalfEquirectangularControllerConfig());b("SphericalVideoComponentDispatcher").explicitlyRegisterStores([b("SphericalViewportControlStore"),b("VideoPlayerControllerStore")]);var f=new(b("SphericalViewportControl"))(c,this.$10,d);this.$8.addSubscriptions(f.addListener("DOM/click",function(b){if(b.button!==0)return;a.$1.clickVideo();b.preventDefault()}),f.addListener("mouseMove",function(b){a.$1.mouseMove(b),b.preventDefault()}),f.addListener("mouseUp",function(b){a.$1.mouseUp(b),b.preventDefault()}),f.addListener("mouseLeave",function(b){a.$1.mouseLeave(b),b.preventDefault()}),f.addListener("updateViewportBegin",function(){a.$1.isMuted()&&a.$18&&(a.$18=!1,a.$1.unmute()),a.$1.logEvent("viewport_rotated")}));this.$8.addSubscriptions(f.addListener("viewportChange",this.$52));e=["DOM/click","updateViewportBegin","updateViewportMove","updateViewportEnd","wheelScroll","viewportChange"];this.$8.addSubscriptions.apply(this.$8,e.map(function(c){return b("forwardEvent")(f,a.$1,c)}));this.$12=f;b("Arbiter").subscribe("VideoChannelView/opened",function(){a.$21=!0,a.$12.disableKeyboard()});b("Arbiter").subscribe("VideoChannelView/closed",function(){a.$21=!1,a.$12.enableKeyboard()});b("FullScreen").subscribe("changed",function(){b("FullScreen").isFullScreen()?a.$12.enableKeyboard():a.$21&&a.$12.disableKeyboard()});this.$11.preventScrollDefaultAction&&this.$12.setPreventScrollDefaultAction(!0);b("SphericalVideoComponentActions").registerSphericalViewportControl(this.$1.getVideoPlayerID(),this.$12,this.$4);this.$1.registerOption("SphericalVideoPlayer","getCurrentViewport",function(){return a.$19});this.$1.registerOption("SphericalVideoPlayer","getFieldOfView",function(){return a.$20});this.$4=c;b("DOM").insertAfter(this.$2,c);this.$11.useViewportDimension&&(this.$6=b("DOMDimensions").getElementDimensions(c))};d.$47=function(){var a=this,c={canvasAttrs:{width:this.$5.width,height:this.$5.height,className:this.$11.canvasClassName,tabIndex:0},beforeCanvasLost:function(){return a.$49()}};c=b("SphericalMediaCanvasPool").get(this.$15,c,j);var d=new(b("SphericalRenderer"))(this.$2,c,this.$10);this.$9=new(b("SubscriptionsHandler"))();this.$9.addSubscriptions(d.addListener("renderingError",function(b){return a.$31({error:"SPHERICAL_RENDER_ERROR",message:b.message})}),d.addListener("renderingContextLost",this.$50));this.$3=c;this.$14=d;b("DOM").insertAfter(this.$2,c);this.$53(d,this.$5.width,this.$5.height);b("requestAnimationFrame")(this.$54);b("CSS").show(c)};d.$55=function(){var a=this.$1.getRootNode();if(!a)return null;a=b("getElementRect")(a);a=a.top+a.bottom/2;var c=b("getViewportDimensions").withoutScrollbars().height;a=a/c*100;c=this.$12.getHorizontalFieldOfView();a=i(a,null,null,c);c=a.yaw;a=a.success;return a?c:null};d.$56=function(a){if(typeof this.$26!=="number")return!1;typeof this.$25!=="number"&&(this.$25=0);var b=Math.abs(this.$25-this.$26);if(b<n)return!1;b=b*l;a=Math.max(a,m);this.$25<this.$26?this.$25+=Math.min(this.$26-this.$25,b*a):this.$25-=Math.min(this.$25-this.$26,b*a);return!0};d.$31=function(a){this.$1.logError(a),this.$1.emit("error",a),this.$35()};d.$44=function(){return this.$1.isState("playing")};d.$58=function(a){if(!this.$25)return;this.$24=a-this.$25};d.$53=function(a,c,d){a.updateViewportDimensions(c,d),b("SphericalVideoComponentActions").updateViewportDimensions(this.$1.getVideoPlayerID(),c,d)};d.$32=function(){this.$7=!0};d.$59=function(a,c){var d=Date.now();if(d-this.$22>=k){this.$22=d;var e=!!this.$1.getOption("VideoWithSphericalGuide","auto");b("Banzai").post("spherical_video_viewport",{video_fbid:this.$1.getVideoID(),yaw_degrees:a,pitch_degrees:c,roll_degrees:0,field_of_view_y:this.$10.fieldOfView,aspect_ratio:this.$5.height/this.$5.width,video_player_position:this.$2.currentTime,video_player_position_ms:this.$2.currentTime*1e3,guide_enabled:e,timestamp:d})}};d.$57=function(){this.$14&&(this.$14.destroy(),this.$14=null,this.$27&&this.$27.remove(),this.$27=null,this.$9.release(),this.$3.remove())};d.$35=function(){this.$1.hasOption("SphericalVideoPlayer","isUnavailable")||this.$1.registerOption("SphericalVideoPlayer","isUnavailable",function(){return!0}),this.$8&&this.$8.release(),this.$57(),this.$12&&this.$12.destroy(),this.$13&&this.$13.destroy(),this.$4&&this.$4.remove()};d.$51=function(){return{disableAutoClientSizeUpdate:!1,enableGyro:!1,enableRubberBanding:!1,maxSpringDegrees:0,maxStretchXDegrees:0,maxStretchYDegrees:0,minVFOV:3,rubberBandConstant:0,slipFactor:0,springFactor:0,enableZoomWithShiftKey:!1,enablePanningWithRightMouse:!1}};return c}();e.exports=d}),null);